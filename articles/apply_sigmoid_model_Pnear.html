<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BayesPharma">
<title>Apply: Sigmoid Model -- Pnear Folding Funnel • BayesPharma</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply: Sigmoid Model -- Pnear Folding Funnel">
<meta property="og:description" content="BayesPharma">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesPharma</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/apply_MuSyC_model_KCNQ_conductance.html">Apply: MuSyC Model -- KCNQ Conductance</a>
    <a class="dropdown-item" href="../articles/apply_sigmoid_model_KOR_antagonists.html">Apply: Sigmoid Model -- KOR Antagonists</a>
    <a class="dropdown-item" href="../articles/apply_sigmoid_model_Pnear.html">Apply: Sigmoid Model -- Pnear Folding Funnel</a>
    <a class="dropdown-item" href="../articles/apply_tQ_model_ChABC_design.html">Apply: tQ Model -- ChABC Design</a>
    <a class="dropdown-item" href="../articles/apply_tQ_model_nSMase2_kinetics.html">Apply: tQ Model -- nSMase2 Kinetics</a>
    <a class="dropdown-item" href="../articles/derive_MuSyC_model.html">Derive: MuSyC Model -- Synergy Analysis</a>
    <a class="dropdown-item" href="../articles/derive_tQ_model.html">Derive: tQ Model -- Enzyme Kinetics</a>
    <a class="dropdown-item" href="../articles/implement_tidymodels.html">Implement: BayesPharma and Tidymodels</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Apply: Sigmoid Model -- Pnear Folding Funnel</h1>
            
      
      
      <div class="d-none name"><code>apply_sigmoid_model_Pnear.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="modeling-folding-funnels">Modeling Folding Funnels<a class="anchor" aria-label="anchor" href="#modeling-folding-funnels"></a>
</h2>
<p>A common task in molecular modeling is to predict the conformation of
the folded state for a given molecular system. For example, the Rosetta
<em>ab initio</em>, or protein-protein-interface docking protocols. To
turn the simulation into a prediction requires predicting the relative
free energy of the folded state relative a reference.</p>
<p>The Rosetta score function can score individual conformations, but
doesn’t capture the free energy of the state. Typically, a researcher
will run a series of trajectories and generate a <strong>score vs. RMSD
plot</strong> and look for a “folding funnel” e.g. lower energies for
conformations that are closer to a target folded state. Here, RMSD is
the root-mean squared deviation measuring the euclidean distance of
pairs of atom defined by the application (for example just the backbone
for sequence design or interface atoms for docking).</p>
<div class="section level3">
<h3 id="pnear-score">Pnear score<a class="anchor" aria-label="anchor" href="#pnear-score"></a>
</h3>
<p>To quantify the quality of the folding funnel, recently, there has
been interest in using the <strong>Pnear score</strong>, which is
defined by</p>
<pre><code><span><span class="va">Pnear</span> <span class="op">=</span> <span class="va">Sum_i</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">RMSD</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">lambda</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">score</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">k_BT</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span></span>
<span>        <span class="va">Sum_i</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">score</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="va">k_BT</span><span class="op">)</span><span class="op">]</span></span></code></pre>
<p>where <em>(RMSD[i], score[i])</em> is the score RMSD and score values
for a conformation <em>i</em>. The parameter <em>lambda</em> is measured
in Angstroms indicating the breadth of the Gaussian used to define
“native-like-ness”. The bigger the value, the more permissive the
calculation is to structures that deviate from native. Typical values
for peptides range from 1.5 to 2.0, and for proteins from 2.0 to perhaps
4.0. And finally the parameter <em>k_BT</em> is measured in in energy
units, determines how large an energy gap must be in order for a
sequence to be said to favour the native state. The default value, 0.62,
should correspond to physiological temperature for ref2015 or any other
scorefunction with units of kcal/mol.</p>
</div>
<div class="section level3">
<h3 id="two-state-model">Two state model<a class="anchor" aria-label="anchor" href="#two-state-model"></a>
</h3>
<p>Thinking of the folded and unfolded states as a two-state model and
RSMD as a reaction coordinate or “collective variable”, then the energy
gap can be modeled by a sigmoidal Boltzmann distribution.</p>
<pre><code><span><span class="co">## Warning in xkcd::theme_xkcd(): Not xkcd fonts installed! See</span></span>
<span><span class="co">## vignette("xkcd-intro")</span></span></code></pre>
<pre><code><span><span class="co">## Warning in theme_xkcd(): Not xkcd fonts installed! See vignette("xkcd-intro")</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## ℹ Please use `linewidth` instead.</span></span></code></pre>
<p><img src="apply_sigmoid_model_Pnear_files/sigmoidal-cartoon-1.png" alt="plot of chunk sigmoidal-cartoon" width="100%" style="display: block; margin: auto;"></p>
<p>For a principled molecular dynamics or monte carlo simulation that
maintains detailed balance, it is in theory possible to use
thermodynamic integration to quantify the energy gap between the two
states. However, this is often not computationally feasible for proteins
of moderate size or in a protein design or screening context where many
different molecules need to be evaluated given a limited computational
budget. So, Instead, we will assume that the at least locally around the
folded state, the degrees of freedom increase exponentially so that the
log of the RMSD defines a linear reaction coordinate.</p>
<p>If we simulate, trajectory points from the sigmoid on the log(RMSD)
scale, with a Normally distributed error we can generate synthetic
score-vs-rmsd plots</p>
<p><img src="apply_sigmoid_model_Pnear_files/simulate-score-vs-rmsd-data-1.png" alt="plot of chunk simulate-score-vs-rmsd-data" width="100%" style="display: block; margin: auto;"></p>
<p>A nice thing about having the parametric model to generate
score-vs-rmsd plots, is that it allows us to measure measure the
sensitivity of the Pnear to differently shaped score-vs-rmsd plots. For
example we can scan both the radius of</p>
<p><img src="apply_sigmoid_model_Pnear_files/simulate-data-scan-1.png" alt="plot of chunk simulate-data-scan" width="100%" style="display: block; margin: auto;"></p>
<p>Another question we can use this model to investigate is how
reproducible is the Pnear score?</p>
<p><img src="apply_sigmoid_model_Pnear_files/simulated-replicates-1.png" alt="plot of chunk simulated-replicates" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="antibody-snugdock-case-study">Antibody SnugDock Case study<a class="anchor" aria-label="anchor" href="#antibody-snugdock-case-study"></a>
</h2>
<p>As a case study, we can look at the real score-vs-rmsd plots from the
Antibody SnugDock scientific benchmark. It is evaluates the SnugDock
protocol over 6 Antibody protein targets</p>
<p>We can use the fit the sigmoid model to the <code>log(RMSD)</code>
using the <code>BayesPharma</code> package, which relies on
<code>BRMS</code> and <code>Stan</code></p>
<p>Check the model parameter fit and estimated parameters:</p>
<pre><code><span><span class="co">##  Family: gaussian </span></span>
<span><span class="co">##   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">## Formula: response ~ sigmoid(ec50, hill, top, bottom, log_dose) </span></span>
<span><span class="co">##          ec50 ~ 0 + target</span></span>
<span><span class="co">##          hill ~ 0 + target</span></span>
<span><span class="co">##          top ~ 0 + target</span></span>
<span><span class="co">##          bottom ~ 0 + target</span></span>
<span><span class="co">##    Data: data (Number of observations: 3003) </span></span>
<span><span class="co">##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;</span></span>
<span><span class="co">##          total post-warmup draws = 8000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Population-Level Effects: </span></span>
<span><span class="co">##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## ec50_target1ahw       1.70      0.11     1.43     1.86 1.00     3953     2291</span></span>
<span><span class="co">## ec50_target1jps       1.37      0.13     1.08     1.59 1.00     4498     3746</span></span>
<span><span class="co">## ec50_target1mlc       2.39      0.53     0.96     3.19 1.00     2772     2019</span></span>
<span><span class="co">## ec50_target1ztx       0.75      0.08     0.59     0.90 1.00     5504     4507</span></span>
<span><span class="co">## ec50_target2aep       1.13      0.37     0.57     1.55 1.00     2119      883</span></span>
<span><span class="co">## ec50_target2jel       1.65      0.06     1.53     1.76 1.00     6454     5339</span></span>
<span><span class="co">## hill_target1ahw       1.68      0.45     0.86     2.63 1.00     3298     1816</span></span>
<span><span class="co">## hill_target1jps       1.49      0.36     0.89     2.28 1.00     3824     3753</span></span>
<span><span class="co">## hill_target1mlc       1.04      0.55     0.26     2.28 1.00     2646     2932</span></span>
<span><span class="co">## hill_target1ztx       2.72      0.56     1.75     3.91 1.00     7260     5789</span></span>
<span><span class="co">## hill_target2aep       1.98      0.68     0.59     3.38 1.00     1121      382</span></span>
<span><span class="co">## hill_target2jel       3.21      0.59     2.15     4.45 1.00     7535     5573</span></span>
<span><span class="co">## top_target1ahw      -10.54      0.75   -11.56    -8.64 1.00     4452     2288</span></span>
<span><span class="co">## top_target1jps       -9.69      0.58   -10.62    -8.34 1.00     5219     4202</span></span>
<span><span class="co">## top_target1mlc       -1.31      5.93    -9.93    12.77 1.00     6763     5064</span></span>
<span><span class="co">## top_target1ztx      -17.44      0.27   -17.97   -16.90 1.00    11553     5251</span></span>
<span><span class="co">## top_target2aep      -16.13      1.92   -16.95   -15.13 1.00     1218      401</span></span>
<span><span class="co">## top_target2jel      -11.09      0.33   -11.73   -10.45 1.00    10630     6010</span></span>
<span><span class="co">## bottom_target1ahw   -26.08      2.23   -31.80   -23.14 1.00     3373     1914</span></span>
<span><span class="co">## bottom_target1jps   -30.53      3.72   -39.60   -24.96 1.00     4356     3831</span></span>
<span><span class="co">## bottom_target1mlc   -18.48      4.42   -31.68   -14.74 1.00     2184     1868</span></span>
<span><span class="co">## bottom_target1ztx   -38.84      3.50   -46.77   -32.98 1.00     5786     4464</span></span>
<span><span class="co">## bottom_target2aep   -30.25      5.82   -43.46   -21.26 1.00     6001     4926</span></span>
<span><span class="co">## bottom_target2jel   -19.46      0.98   -21.59   -17.74 1.00     6528     4703</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family Specific Parameters: </span></span>
<span><span class="co">##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## sigma     5.74      0.07     5.60     5.89 1.00    12452     5130</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre>
<p>Excitingly, using leave-one-out cross-validation, the sigmoid model
fits the data very well</p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Computed from 8000 by 3003 log-likelihood matrix</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          Estimate   SE</span></span>
<span><span class="co">## elpd_loo  -9521.3 39.0</span></span>
<span><span class="co">## p_loo        21.4  1.2</span></span>
<span><span class="co">## looic     19042.7 78.0</span></span>
<span><span class="co">## ------</span></span>
<span><span class="co">## Monte Carlo SE of elpd_loo is 0.1.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## All Pareto k estimates are good (k &lt; 0.5).</span></span>
<span><span class="co">## See help('pareto-k-diagnostic') for details.</span></span></code></pre>
<p>Visualize the fit as draws from the expected mean and median quantile
intvervals on the log(RMSD) scale:</p>
<p><img src="apply_sigmoid_model_Pnear_files/plot-data-model-1.png" alt="plot of chunk plot-data-model" width="100%" style="display: block; margin: auto;">
And on the original RMSD scale:</p>
<p><img src="apply_sigmoid_model_Pnear_files/plot-data-model-rmsd-1.png" alt="plot of chunk plot-data-model-rmsd" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="quantify-pnear-uncertainty">Quantify Pnear uncertainty<a class="anchor" aria-label="anchor" href="#quantify-pnear-uncertainty"></a>
</h3>
<p>Using the two-state model fit, it is possible to propagate the
posterior uncertainty to estimate the uncertainty of the Pnear.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Madeline Martin, Matthew O’Meara.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
