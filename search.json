[{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_MuSyC_KCNQ.html","id":"re-analysis-figure-1-of-li-et-al--2021-molecular-basis-for-ligand-activation-of-the-human-kcnq2-channel","dir":"Articles","previous_headings":"","what":"Re-analysis Figure 1 of (Li, et al., 2021) Molecular Basis for Ligand Activation of the Human KCNQ2 Channel","title":"Apply: MuSyC Model -- KCNQ Conductance","text":"KCNQ2 voltage gated potassium channel important re-establishing neuronal homeostasis following action potential. Dis-regulation channels KCNQ family can cause epilepsy, tinnitus, depression. sustained interest developing small-molecule based therapeutics targeting KCNQ2, FDA approved drug targets KCNQ2, retigabine, given black-box warning due unwanted side-effects, even though effective treating epilepsy. Excitingly recent progress using Cryo-EM structurally characterize ion channels including KCNQ2, promise support structure-based drug design. Recently, (Li et al. 2021) used Cryo-EM characterize structure KCNQ2 complex retigabine, interacts membrane outside pore, ztz240, interacts voltage sensor domain. relate structure function, (Li et al. 2021) measured conductance function voltage (G-V curves) presence varying doses retigabine ztz240 using whole cell patch-clamp electrophysiology Chinese hamster ovary (CHO)-K1 cells overexpressing KCNQ2. compounds thought agonists, increasing concentration drug, less negative voltages required open channel. case study, aim re-analyze effects retigabine ztz240 using data collected (Li et al. 2021) presented panels B D figure 1. key idea recognize voltage drug treatment can thought independent perturbations drug effect can framed characterizing interaction perturbations. begin, load plot data, Reproduction Figure 1b 1d (Li, et al., 2021) , treatment dose, fit sigmoid curve, comparable functional form call Boltzmann equation G/Gmax function voltage. make fitting stable, transform treatment response scales. plot chunk model-conductance-prior-posterior plot chunk model-conductance-predictive Fit MuSyC Model Join conductance model dose information model voltage dependence depends drug dose plot chunk plot-voltage--dose","code":"## # A tibble: 1,856 × 6 ##    treatment dose_uM is_control voltage replica   conductance ##    <chr>       <dbl> <lgl>        <dbl> <chr>           <dbl> ##  1 ztz240         10 TRUE           -90 replica_1      0.0403 ##  2 ztz240         10 TRUE           -90 replica_2      0.0632 ##  3 ztz240         10 TRUE           -90 replica_3      0.0200 ##  4 ztz240         10 TRUE           -90 replica_4      0.0404 ##  5 ztz240         10 TRUE           -90 replica_5      0.0175 ##  6 ztz240         10 TRUE           -80 replica_1      0.0469 ##  7 ztz240         10 TRUE           -80 replica_2      0.0682 ##  8 ztz240         10 TRUE           -80 replica_3      0.0345 ##  9 ztz240         10 TRUE           -80 replica_4      0.0574 ## 10 ztz240         10 TRUE           -80 replica_5      0.0339 ## # ℹ 1,846 more rows model_conductance <- BayesPharma::sigmoid_model(   data = model_data,   formula = BayesPharma::sigmoid_agonist_formula(     treatment_variable = \"voltage\",     treatment_units = \"mV\",     response_variable = \"conductance\",     response_units = \"% Gmax\",     predictors = 0 + treatment:doselabel),   prior = BayesPharma::sigmoid_agonist_prior(     ec50 = brms::prior(normal(-0.2, 1), nlpar = \"ec50\"),     hill = brms::prior(normal(3, 2), nlpar = \"hill\", lb = 0)),   init = BayesPharma::sigmoid_agonist_init(     ec50 = \\() runif(1, min = -7, max = -5),     hill = \\() runif(1, min = 0.8, max = 1.2),     bottom = \\() runif(1, min = -.1, max = 0.1),     top = \\() runif(1, min = 0.8, max = 1.2)),   cores = 4) ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: conductance ~ sigmoid(ec50, hill, top, bottom, voltage)  ##          ec50 ~ 0 + treatment:doselabel ##          hill ~ 0 + treatment:doselabel ##          top ~ 0 + treatment:doselabel ##          bottom ~ 0 + treatment:doselabel ##    Data: data (Number of observations: 928)  ##   Draws: 4 chains, each with iter = 8000; warmup = 4000; thin = 1; ##          total post-warmup draws = 16000 ##  ## Population-Level Effects:  ##                                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## ec50_treatmentretigabine:doselabel0.1uM      -0.20      0.99    -2.13     1.72 1.00    31481    11496 ## ec50_treatmentztz240:doselabel0.1uM          -0.12      0.01    -0.14    -0.09 1.00    23072    11779 ## ec50_treatmentretigabine:doselabel0.3uM      -0.19      0.01    -0.21    -0.17 1.00    23620    12800 ## ec50_treatmentztz240:doselabel0.3uM          -0.20      0.99    -2.15     1.73 1.00    33491    12190 ## ec50_treatmentretigabine:doselabel1uM        -0.25      0.01    -0.28    -0.22 1.00    22963    12804 ## ec50_treatmentztz240:doselabel1uM            -0.19      0.01    -0.22    -0.17 1.00    23523    12045 ## ec50_treatmentretigabine:doselabel10uM       -0.45      0.01    -0.48    -0.43 1.00    17121    11505 ## ec50_treatmentztz240:doselabel10uM           -0.44      0.01    -0.45    -0.42 1.00    23429    12318 ## ec50_treatmentretigabine:doselabel3uM        -0.36      0.01    -0.38    -0.33 1.00    21177    12455 ## ec50_treatmentztz240:doselabel3uM            -0.32      0.01    -0.34    -0.30 1.00    22522    13052 ## ec50_treatmentretigabine:doselabel30uM       -0.43      0.01    -0.46    -0.40 1.00    16711    10825 ## ec50_treatmentztz240:doselabel30uM           -0.20      1.00    -2.13     1.75 1.00    33246    11397 ## ec50_treatmentretigabine:doselabel5uM        -0.40      0.01    -0.42    -0.37 1.00    19719    12734 ## ec50_treatmentztz240:doselabel5uM            -0.32      0.01    -0.34    -0.30 1.00    22419    12999 ## hill_treatmentretigabine:doselabel0.1uM       3.27      1.78     0.31     7.05 1.00    12001     6654 ## hill_treatmentztz240:doselabel0.1uM           2.48      0.21     2.09     2.91 1.00    15616    11802 ## hill_treatmentretigabine:doselabel0.3uM       3.02      0.24     2.57     3.53 1.00    16313    12006 ## hill_treatmentztz240:doselabel0.3uM           3.25      1.78     0.26     6.93 1.00     9117     5445 ## hill_treatmentretigabine:doselabel1uM         2.57      0.21     2.17     3.00 1.00    16147    10272 ## hill_treatmentztz240:doselabel1uM             2.85      0.21     2.46     3.28 1.00    17076    11776 ## hill_treatmentretigabine:doselabel10uM        2.89      0.24     2.43     3.39 1.00    13906    11153 ## hill_treatmentztz240:doselabel10uM            5.00      0.43     4.22     5.89 1.00    19509    12712 ## hill_treatmentretigabine:doselabel3uM         3.12      0.26     2.63     3.67 1.00    16865    12473 ## hill_treatmentztz240:doselabel3uM             3.39      0.27     2.89     3.96 1.00    19367    12542 ## hill_treatmentretigabine:doselabel30uM        2.78      0.22     2.37     3.23 1.00    13675    11399 ## hill_treatmentztz240:doselabel30uM            3.26      1.77     0.31     6.99 1.00    10308     5374 ## hill_treatmentretigabine:doselabel5uM         3.12      0.26     2.65     3.65 1.00    15298    12668 ## hill_treatmentztz240:doselabel5uM             3.88      0.30     3.33     4.49 1.00    19205    12216 ## top_treatmentretigabine:doselabel0.1uM        1.01      0.50     0.01     2.00 1.00    32180    10490 ## top_treatmentztz240:doselabel0.1uM            0.99      0.02     0.95     1.04 1.00    16438    11203 ## top_treatmentretigabine:doselabel0.3uM        0.97      0.02     0.94     1.00 1.00    18530    12344 ## top_treatmentztz240:doselabel0.3uM            1.00      0.50     0.03     1.98 1.00    32623    10972 ## top_treatmentretigabine:doselabel1uM          0.98      0.02     0.95     1.01 1.00    17680    10151 ## top_treatmentztz240:doselabel1uM              0.93      0.01     0.90     0.96 1.00    19281    12007 ## top_treatmentretigabine:doselabel10uM         0.96      0.01     0.94     0.99 1.00    20534    12361 ## top_treatmentztz240:doselabel10uM             0.93      0.01     0.91     0.95 1.00    22913    13862 ## top_treatmentretigabine:doselabel3uM          0.95      0.01     0.93     0.98 1.00    22725    12834 ## top_treatmentztz240:doselabel3uM              0.96      0.01     0.94     0.99 1.00    24302    12648 ## top_treatmentretigabine:doselabel30uM         0.96      0.01     0.94     0.99 1.00    19553    11895 ## top_treatmentztz240:doselabel30uM             1.00      0.49     0.04     1.96 1.00    31101    11233 ## top_treatmentretigabine:doselabel5uM          0.96      0.01     0.94     0.99 1.00    19828    12874 ## top_treatmentztz240:doselabel5uM              0.95      0.01     0.93     0.98 1.00    23635    12851 ## bottom_treatmentretigabine:doselabel0.1uM     0.00      0.50    -0.97     0.98 1.00    32703    11571 ## bottom_treatmentztz240:doselabel0.1uM         0.01      0.02    -0.03     0.04 1.00    18527    11372 ## bottom_treatmentretigabine:doselabel0.3uM     0.02      0.02    -0.02     0.05 1.00    18223    12049 ## bottom_treatmentztz240:doselabel0.3uM        -0.00      0.49    -0.95     0.94 1.00    31153    12072 ## bottom_treatmentretigabine:doselabel1uM       0.00      0.02    -0.04     0.04 1.00    15601    11561 ## bottom_treatmentztz240:doselabel1uM          -0.02      0.02    -0.05     0.01 1.00    18952    10800 ## bottom_treatmentretigabine:doselabel10uM     -0.04      0.03    -0.10     0.02 1.00    13560    10667 ## bottom_treatmentztz240:doselabel10uM         -0.00      0.02    -0.04     0.03 1.00    18881    12136 ## bottom_treatmentretigabine:doselabel3uM      -0.01      0.02    -0.06     0.03 1.00    16385    11431 ## bottom_treatmentztz240:doselabel3uM          -0.02      0.02    -0.06     0.02 1.00    19121    12264 ## bottom_treatmentretigabine:doselabel30uM     -0.07      0.03    -0.13    -0.02 1.00    13362    10313 ## bottom_treatmentztz240:doselabel30uM          0.00      0.50    -0.97     1.00 1.00    35198    11699 ## bottom_treatmentretigabine:doselabel5uM      -0.05      0.03    -0.10    -0.00 1.00    15103    11293 ## bottom_treatmentztz240:doselabel5uM           0.00      0.02    -0.03     0.04 1.00    19016    11999 ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma     0.06      0.00     0.06     0.06 1.00    27569    12251 ##  ## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1). model_conductance |>   BayesPharma::plot_prior_posterior_densities(refresh = 0) model_conductance |>   BayesPharma::plot_posterior_draws() ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ## # A tibble: 44 × 15 ##    variable_type variable predictors_label                     mean median      sd     mad     q5     q95  rhat ess_bulk ess_tail treatment  logdose doselabel ##    <chr>         <chr>    <chr>                               <dbl>  <dbl>   <dbl>   <dbl>  <dbl>   <dbl> <dbl>    <dbl>    <dbl> <chr>        <dbl> <fct>     ##  1 b             ec50     treatmentztz240:doselabel0.1uM     -0.116 -0.116 0.0147  0.0148  -0.140 -0.0918  1.00   23072.   11779. ztz240       -7    0.1 uM    ##  2 b             ec50     treatmentretigabine:doselabel0.3uM -0.189 -0.189 0.0121  0.0122  -0.209 -0.170   1.00   23620.   12800. retigabine   -6.52 0.3 uM    ##  3 b             ec50     treatmentretigabine:doselabel1uM   -0.247 -0.247 0.0144  0.0144  -0.271 -0.224   1.00   22963.   12804. retigabine   -6    1 uM      ##  4 b             ec50     treatmentztz240:doselabel1uM       -0.194 -0.194 0.0117  0.0117  -0.213 -0.175   1.00   23523.   12045. ztz240       -6    1 uM      ##  5 b             ec50     treatmentretigabine:doselabel10uM  -0.451 -0.451 0.0139  0.0137  -0.475 -0.429   1.00   17121.   11505. retigabine   -5    10 uM     ##  6 b             ec50     treatmentztz240:doselabel10uM      -0.438 -0.438 0.00828 0.00821 -0.452 -0.425   1.00   23429.   12318. ztz240       -5    10 uM     ##  7 b             ec50     treatmentretigabine:doselabel3uM   -0.356 -0.356 0.0124  0.0124  -0.376 -0.336   1.00   21177.   12455. retigabine   -5.52 3 uM      ##  8 b             ec50     treatmentztz240:doselabel3uM       -0.322 -0.322 0.0108  0.0108  -0.340 -0.304   1.00   22522.   13052. ztz240       -5.52 3 uM      ##  9 b             ec50     treatmentretigabine:doselabel30uM  -0.430 -0.429 0.0136  0.0133  -0.453 -0.408   1.00   16711.   10825. retigabine   -4.52 30 uM     ## 10 b             ec50     treatmentretigabine:doselabel5uM   -0.398 -0.398 0.0122  0.0120  -0.418 -0.378   1.00   19719.   12734. retigabine   -5.30 5 uM      ## # ℹ 34 more rows ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: conductance ~ sigmoid(sigmoid(Eec50, Ehill, Etop, Ebottom, logdose), sigmoid(Hec50, Hhill, Htop, Hbottom, logdose), vtop, vbottom, voltage)  ##          vtop ~ 1 ##          vbottom ~ 1 ##          Eec50 ~ 0 + treatment ##          Ehill ~ 0 + treatment ##          Etop ~ 0 + treatment ##          Ebottom ~ 0 + treatment ##          Hec50 ~ 0 + treatment ##          Hhill ~ 0 + treatment ##          Htop ~ 0 + treatment ##          Hbottom ~ 0 + treatment ##    Data: model_data (Number of observations: 928)  ##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; ##          total post-warmup draws = 4000 ##  ## Population-Level Effects:  ##                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## vtop_Intercept                  0.95      0.00     0.95     0.96 1.00     5150     3106 ## vbottom_Intercept              -0.00      0.01    -0.01     0.01 1.00     4194     3140 ## Eec50_treatmentretigabine      -5.77      0.07    -5.91    -5.65 1.00     2859     2377 ## Eec50_treatmentztz240          -5.46      0.06    -5.56    -5.34 1.00     2708     1923 ## Ehill_treatmentretigabine      -1.61      0.26    -2.15    -1.13 1.00     2513     2161 ## Ehill_treatmentztz240          -1.46      0.18    -1.84    -1.15 1.00     2599     2729 ## Etop_treatmentretigabine       -0.19      0.02    -0.22    -0.15 1.00     2486     2172 ## Etop_treatmentztz240           -0.14      0.01    -0.15    -0.12 1.00     4059     2731 ## Ebottom_treatmentretigabine    -0.43      0.01    -0.44    -0.41 1.00     3186     2744 ## Ebottom_treatmentztz240        -0.48      0.02    -0.54    -0.44 1.00     2358     1922 ## Hec50_treatmentretigabine      -3.95      1.86    -8.20    -0.28 1.00     1147     1550 ## Hec50_treatmentztz240          -5.15      0.21    -5.51    -4.71 1.00     2286     2672 ## Hhill_treatmentretigabine       1.26      0.75     0.22     3.05 1.00     2134     1414 ## Hhill_treatmentztz240           1.77      0.49     1.03     2.97 1.00     2880     3098 ## Htop_treatmentretigabine        4.44      1.58     2.41     8.13 1.00     2009     2038 ## Htop_treatmentztz240            5.83      1.15     4.28     8.61 1.00     2467     2620 ## Hbottom_treatmentretigabine     2.99      0.09     2.81     3.16 1.00     2755     2998 ## Hbottom_treatmentztz240         2.83      0.08     2.68     3.00 1.00     4726     2894 ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma     0.06      0.00     0.06     0.06 1.00     4014     2555 ##  ## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1). ##               elpd_diff se_diff ## model_bilevel    0.0       0.0  ## model_MuSyC   -125.5      17.2"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"sec-hill","dir":"Articles","previous_headings":"","what":"Hill Equation","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"case study, going reanalyze dose responses 4 Kappa Opioid receptor (KOR) antagonists study performed Margolis et al. (-@Margolis2020-bm) using BayesPharma package. Whole cell electrophysiology acute rat midbrain slices used evaluate pharmacological properties four novel KOR antagonists: BTRX-335140, BTRX-395750, PF-04455242, JNJ-67953964. Originally, dose-response analysis performed using drc package R, implements minimization negative log likelihood function reduces least square estimation continuous response. data normalized % baseline agonist response, measuring extent blockade agonist response presence different concentrations antagonist. data fit 4-parameter log-logistic dose response model, setting top (max agonist response) 100% estimating IC50, variance, bottom (min agonist response).","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"fitting-the-sigmoid-model","dir":"Articles","previous_headings":"Hill Equation","what":"Fitting the sigmoid model","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"Using BayesPharma package, can re-fit sigmoid model negative slope, fix top parameter 100 response normalized -antagonist baseline. prior, going use normal distribution response values continuous. First, run analysis top (max response) parameter prior set constant value 100 top normalized 100 default broad prior ic50, hill, bottom parameters. Broad priors represent unbiased uncertainty provide opportunity extreme responses. level informativeness prior affect much influence prior model. information prior choice recommendations.","code":"kor_prior <- BayesPharma::sigmoid_antagonist_prior(top = 100) kor_prior ##            prior class coef group resp dpar  nlpar   lb   ub source ##  normal(-6, 2.5)     b                        ic50 <NA> <NA>   user ##    normal(-1, 1)     b                        hill <NA> 0.01   user ##    constant(100)     b                         top <NA> <NA>   user ##   normal(0, 0.5)     b                      bottom <NA> <NA>   user"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"prior-predictive-checks","dir":"Articles","previous_headings":"Hill Equation > Fitting the sigmoid model","what":"Prior predictive checks","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"Following Bayesian workflow, fitting model, good check prior predictive distributions see compatible domain expertise. , running model, verify prior distributions cover plausible range values parameter. , want sample prior distributions adding sample_prior = \"\" argument sigmoid_model function. use default response distribution model (family = gaussian()). plot prior predictive distributions: KOR antagonists prior distribution sample model, use Stan NUTs Hamiltonian Monte Carlo, initialize parameters prior means help model convergence, using default values ec50 = -9, hill = -1, top = 100, bottom = 0.","code":"kor_sample_prior <- BayesPharma::sigmoid_model(   data = kor_antag |> dplyr::select(substance_id, log_dose, response),   formula = BayesPharma::sigmoid_antagonist_formula(),   prior = kor_prior,   init = BayesPharma::sigmoid_antagonist_init(),   sample_prior = \"only\") kor_sample_prior |>   BayesPharma::plot_density_distribution() kor_model <- BayesPharma::sigmoid_model(   data = kor_antag |> dplyr::select(substance_id, log_dose, response),   formula = BayesPharma::sigmoid_antagonist_formula(     predictors = 0 + substance_id),    prior = kor_prior,   init = BayesPharma::sigmoid_antagonist_init())"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"analyzing-model-fit","dir":"Articles","previous_headings":"Hill Equation","what":"Analyzing model fit","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"brms generated model summary shows formula expected response sigmoid function log_dose four parameters, shared Gaussian distribution. parameter dependent substance_id. Since want fit separate model substance, include 0 + indicate common intercept. data consists 73 data points posterior sampling done 4 chains 8000 steps 4000 steps warm-. population effects parameter summarize marginal posterior distributions, well effective sample size bulk tail. gives indication sampling quality, ESS > 500 samples good type model.","code":"##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: response ~ sigmoid(ic50, hill, top, bottom, log_dose)  ##          ic50 ~ 0 + substance_id ##          hill ~ 0 + substance_id ##          top ~ 0 + substance_id ##          bottom ~ 0 + substance_id ##    Data: data (Number of observations: 73)  ##   Draws: 4 chains, each with iter = 8000; warmup = 4000; thin = 1; ##          total post-warmup draws = 16000 ##  ## Population-Level Effects:  ##                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## ic50_substance_idBTRX_335140      -8.85      0.20    -9.20    -8.41 1.00    14764     9066 ## ic50_substance_idBTRX_395750      -8.23      0.44    -8.92    -7.34 1.00    12065     5249 ## ic50_substance_idJNJ              -9.15      0.32    -9.77    -8.50 1.00    15862    10777 ## ic50_substance_idPF               -6.17      1.02    -7.60    -3.47 1.00     8884     5702 ## hill_substance_idBTRX_335140      -1.47      0.60    -2.90    -0.59 1.00    16414    11136 ## hill_substance_idBTRX_395750      -0.90      0.51    -2.26    -0.25 1.00    11877     6153 ## hill_substance_idJNJ              -1.00      0.51    -2.40    -0.40 1.00    16195    12044 ## hill_substance_idPF               -0.32      0.24    -0.90    -0.03 1.00     8221     5770 ## bottom_substance_idBTRX_335140     0.00      0.50    -0.96     0.96 1.00    19266    12103 ## bottom_substance_idBTRX_395750     0.01      0.49    -0.93     0.97 1.00    18770    11719 ## bottom_substance_idJNJ            -0.01      0.50    -0.99     0.96 1.00    19182    12000 ## bottom_substance_idPF              0.01      0.50    -0.98     0.98 1.00    18866    11787 ## top_substance_idBTRX_335140      100.00      0.00   100.00   100.00   NA       NA       NA ## top_substance_idBTRX_395750      100.00      0.00   100.00   100.00   NA       NA       NA ## top_substance_idJNJ              100.00      0.00   100.00   100.00   NA       NA       NA ## top_substance_idPF               100.00      0.00   100.00   100.00   NA       NA       NA ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma    32.16      2.90    27.17    38.48 1.00    16111    10587 ##  ## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1)."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"traceplot","dir":"Articles","previous_headings":"Hill Equation > Analyzing model fit","what":"Traceplot","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"model ran without warning messages, meaning parameter value problems MCMC conflicts. bulk tail ESS indicate high resolution stability. R-hat parameter equals 1.00 traceplot shows chains mixed well, indicating chains converged. plot chunk kor-model-traceplot","code":"kor_model |>   bayesplot::mcmc_trace()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"compare-prior-and-posterior-marginal-distributions","dir":"Articles","previous_headings":"Hill Equation > Analyzing model fit","what":"Compare prior and posterior marginal distributions","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"Displayed plot prior posterior distributions parameters (prior pink posterior teal). can useful comparing density distribution prior posterior produced model: KOR antagonists model, compare prior posterior distributions substance Displayed plot posterior distributions parameter confidence intervals mean. useful visual model results can highlight mode high-density intervals: KOR Antagonists, posterior distribution substance Displayed plot sample 100 sigmoid dose-response curves posterior distribution (purple) median quantile intervals: KOR antagonists, posterior draws","code":"BayesPharma::plot_prior_posterior_densities(   model = kor_model,   predictors_col_name = \"substance_id\",   half_max_label = \"ic50\",   title_label=\"\") BayesPharma::plot_posterior_density(   kor_model,    predictors_col_name = \"substance_id\",    half_max_label = \"ic50\",   title_label = \"\") BayesPharma::plot_posterior_draws(   model = kor_model,   title = \"\")"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"comparing-alternative-models","dir":"Articles","previous_headings":"Hill Equation","what":"Comparing alternative models","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"test sensitivity analysis prior, can re-fit model informative prior: Re-fitting model kor_prior2 gives:","code":"##              prior class coef group resp dpar  nlpar   lb   ub source ##  normal(-8.5, 0.5)     b                        ic50 <NA> <NA>   user ##    normal(-1, 0.5)     b                        hill <NA> 0.01   user ##      constant(100)     b                         top <NA> <NA>   user ##     normal(10, 15)     b                      bottom <NA> <NA>   user ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: response ~ sigmoid(ic50, hill, top, bottom, log_dose)  ##          ic50 ~ 0 + substance_id ##          hill ~ 0 + substance_id ##          top ~ 0 + substance_id ##          bottom ~ 0 + substance_id ##    Data: data (Number of observations: 73)  ##   Draws: 4 chains, each with iter = 8000; warmup = 4000; thin = 1; ##          total post-warmup draws = 16000 ##  ## Population-Level Effects:  ##                                Estimate Est.Error l-95% CI u-95% CI Rhat ## ic50_substance_idBTRX_335140      -8.81      0.22    -9.23    -8.36 1.00 ## ic50_substance_idBTRX_395750      -8.58      0.31    -9.16    -7.94 1.00 ## ic50_substance_idJNJ              -8.95      0.31    -9.54    -8.32 1.00 ## ic50_substance_idPF               -8.18      0.45    -9.09    -7.31 1.00 ## hill_substance_idBTRX_335140      -1.19      0.37    -1.98    -0.57 1.00 ## hill_substance_idBTRX_395750      -1.06      0.39    -1.92    -0.42 1.00 ## hill_substance_idJNJ              -0.86      0.32    -1.64    -0.40 1.00 ## hill_substance_idPF               -0.72      0.45    -1.74    -0.07 1.00 ## bottom_substance_idBTRX_335140     1.69     10.55   -19.71    21.78 1.00 ## bottom_substance_idBTRX_395750    15.39     11.05    -7.64    35.95 1.00 ## bottom_substance_idJNJ            -2.72      9.82   -22.83    15.63 1.00 ## bottom_substance_idPF             31.23     11.61     6.78    52.28 1.00 ## top_substance_idBTRX_335140      100.00      0.00   100.00   100.00   NA ## top_substance_idBTRX_395750      100.00      0.00   100.00   100.00   NA ## top_substance_idJNJ              100.00      0.00   100.00   100.00   NA ## top_substance_idPF               100.00      0.00   100.00   100.00   NA ##                                Bulk_ESS Tail_ESS ## ic50_substance_idBTRX_335140      13016    10853 ## ic50_substance_idBTRX_395750      13251    11862 ## ic50_substance_idJNJ              12393    11405 ## ic50_substance_idPF               14103    11188 ## hill_substance_idBTRX_335140      14505     9948 ## hill_substance_idBTRX_395750      12180    10060 ## hill_substance_idJNJ              13486    13152 ## hill_substance_idPF               10262     6935 ## bottom_substance_idBTRX_335140    13738    11212 ## bottom_substance_idBTRX_395750    11894    10144 ## bottom_substance_idJNJ            12846    11477 ## bottom_substance_idPF             11274    10214 ## top_substance_idBTRX_335140          NA       NA ## top_substance_idBTRX_395750          NA       NA ## top_substance_idJNJ                  NA       NA ## top_substance_idPF                   NA       NA ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma    31.86      2.81    26.90    37.84 1.00    14791     9031 ##  ## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1)."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"comparing-the-two-models-using-loo-comparison","dir":"Articles","previous_headings":"","what":"Comparing the Two Models Using LOO-Comparison:","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"One way evaluate quality model data-point, re-fit model remaining points evaluate log probability point posterior distribution. Taking expectation across points gives Expected Log Pointwise predictive Density (ELPD). Since computationally challenging re-fit model point, model fits data reasonably well, ELPD can approximated using Pareto smoothed importance sampling (PSIS). Using LOO package, Pareto k value data point computed indicate well data point fit model, k < 0.5 good, 0.5 <= k < 0.7 OK, 0.7 <= k bad. Evaluating model KOR antagonists shows model fits data well. Since ELPD global measure model fit, can used compare models. Using loo_compare LOO package returns elpd_diff se_diff model relative model lowest ELPD. kor_model2, model informative prior, preferred model, significantly.","code":"## Trying to compile a simple C file ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ##  ## Computed from 16000 by 73 log-likelihood matrix ##  ##          Estimate   SE ## elpd_loo   -360.4  6.5 ## p_loo         6.9  1.1 ## looic       720.8 13.0 ## ------ ## Monte Carlo SE of elpd_loo is 0.0. ##  ## All Pareto k estimates are good (k < 0.5). ## See help('pareto-k-diagnostic') for details. ## Trying to compile a simple C file ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1 ## No problematic observations found. Returning the original 'loo' object. ##            elpd_diff se_diff ## kor_model2  0.0       0.0    ## kor_model  -0.8       1.2"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_KOR.html","id":"analysis-using-the-drc-package","dir":"Articles","previous_headings":"","what":"Analysis Using the drc Package","title":"Apply: Sigmoid Model -- KOR Antagonists","text":"analyze KOR antagonist data using drc package compare results BayesPharma analysis. fix top 100 fit ic50, hill, bottom. Displayed comparison results drc BayesPharma parameter dose-response curve. see Bayesian method provides distribution curve evidence smaller confidence intervals standard errors provided drc method. KOR antagonists conditional effects. blue lines samples BayesPharma kor_model posterior distribution, orange line conditional mean, purple line conditional mean drc model fit.","code":"drc_models <- kor_antag |>   dplyr::group_by(substance_id) |>   dplyr::group_nest() |>   dplyr::mutate(     model = data |>        purrr::map(~drc::drm(         response ~ log_dose,         data = .x,         fct = drc::L.4(fixed = c(NA, NA, 100, NA),         names = c(\"hill\", \"bottom\", \"top\", \"ic50\")))))  drc_models |>   dplyr::mutate(summary = purrr::map(model, broom::tidy, conf.int = TRUE)) |>   tidyr::unnest(summary) |>   dplyr::arrange(term, substance_id) |>   dplyr::select(-data, -model, -curve) ## # A tibble: 12 × 8 ##    substance_id term   estimate std.error statistic  p.value  conf.low conf.high ##    <chr>        <chr>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>     <dbl> ##  1 BTRX_335140  bottom     1.31    19.4      0.0675 9.47e- 1  -40.0        42.6  ##  2 BTRX_395750  bottom    29.5      9.40     3.14   7.85e- 3    9.20       49.8  ##  3 JNJ          bottom   -18.1     26.7     -0.681  5.04e- 1  -73.7        37.4  ##  4 PF           bottom    39.4     30.8      1.28   2.22e- 1  -27.0       106.   ##  5 BTRX_335140  hill       4.06     9.20     0.441  6.65e- 1  -15.5        23.7  ##  6 BTRX_395750  hill       9.82   164.       0.0600 9.53e- 1 -344.        364.   ##  7 JNJ          hill       1.17     0.580    2.02   5.69e- 2   -0.0378      2.38 ##  8 PF           hill       1.13     1.33     0.855  4.08e- 1   -1.73        4.00 ##  9 BTRX_335140  ic50      -8.91     0.308  -28.9    1.42e-14   -9.57       -8.26 ## 10 BTRX_395750  ic50      -8.97     0.505  -17.8    1.70e-10  -10.1        -7.88 ## 11 JNJ          ic50      -8.77     0.670  -13.1    2.89e-11  -10.2        -7.37 ## 12 PF           ic50      -7.96     1.27    -6.29   2.78e- 5  -10.7        -5.23 ## Trying to compile a simple C file ## Running /Library/Frameworks/R.framework/Resources/bin/R CMD SHLIB foo.c ## clang -mmacosx-version-min=10.13 -I\"/Library/Frameworks/R.framework/Resources/include\" -DNDEBUG   -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/Rcpp/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/unsupported\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/BH/include\" -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/src/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/RcppParallel/include/\"  -I\"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rstan/include\" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fPIC  -Wall -g -O2  -c foo.c -o foo.o ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:88: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name 'namespace' ## namespace Eigen { ## ^ ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:16: error: expected ';' after top level declarator ## namespace Eigen { ##                ^ ##                ; ## In file included from <built-in>:1: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22: ## In file included from /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Dense:1: ## /Library/Frameworks/R.framework/Versions/4.2/Resources/miworkspace-library/RcppEigen/include/Eigen/Core:96:10: fatal error: 'complex' file not found ## #include <complex> ##          ^~~~~~~~~ ## 3 errors generated. ## make[1]: *** [foo.o] Error 1"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_model_Pnear.html","id":"modeling-folding-funnels","dir":"Articles","previous_headings":"","what":"Modeling Folding Funnels","title":"Apply: Sigmoid Model -- Pnear Folding Funnel","text":"common task molecular modeling predict conformation folded state given molecular system. example, Rosetta ab initio, protein-protein-interface docking protocols. turn simulation prediction requires predicting relative free energy folded state relative reference. Rosetta score function can score individual conformations, doesn’t capture free energy state. Typically, researcher run series trajectories generate score vs. RMSD plot look “folding funnel” e.g. lower energies conformations closer target folded state. , RMSD root-mean squared deviation measuring euclidean distance pairs atom defined application (example just backbone sequence design interface atoms docking).","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_model_Pnear.html","id":"pnear-score","dir":"Articles","previous_headings":"Modeling Folding Funnels","what":"Pnear score","title":"Apply: Sigmoid Model -- Pnear Folding Funnel","text":"quantify quality folding funnel, recently, interest using Pnear score, defined (RMSD[], score[]) score RMSD score values conformation . parameter lambda measured Angstroms indicating breadth Gaussian used define “native-like-ness”. bigger value, permissive calculation structures deviate native. Typical values peptides range 1.5 2.0, proteins 2.0 perhaps 4.0. finally parameter k_BT measured energy units, determines large energy gap must order sequence said favor native state. default value, 0.62, correspond physiological temperature ref2015 scorefunction units kcal/mol.","code":"Pnear = Sum_i[exp(-RMSD[i]^2/lambda^2)*exp(-score[i]/k_BT)] /         Sum_i[exp(-score[i]/k_BT)]"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_model_Pnear.html","id":"two-state-model","dir":"Articles","previous_headings":"Modeling Folding Funnels","what":"Two state model","title":"Apply: Sigmoid Model -- Pnear Folding Funnel","text":"Thinking folded unfolded states two-state model RSMD reaction coordinate “collective variable”, energy gap can modeled sigmoidal Boltzmann distribution. plot chunk sigmoidal-cartoon principled molecular dynamics Monte Carlo simulation maintains detailed balance, theory possible use thermodynamic integration quantify energy gap two states. However, often computationally feasible proteins moderate size protein design screening context many different molecules need evaluated given limited computational budget. , Instead, assume least locally around folded state, degrees freedom increase exponentially log RMSD defines linear reaction coordinate. simulate, trajectory points sigmoid log(RMSD) scale, Normally distributed error can generate synthetic score-vs-rmsd plots plot chunk simulate-score-vs-rmsd-data nice thing parametric model generate score-vs-rmsd plots, allows us measure measure sensitivity Pnear differently shaped score-vs-rmsd plots. example can scan radius plot chunk simulate-data-scan Another question can use model investigate reproducible Pnear score? plot chunk simulated-replicates","code":"## Warning in xkcd::theme_xkcd(): Not xkcd fonts installed! See ## vignette(\"xkcd-intro\") ## Warning in theme_xkcd(): Not xkcd fonts installed! See vignette(\"xkcd-intro\")"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_model_Pnear.html","id":"antibody-snugdock-case-study","dir":"Articles","previous_headings":"","what":"Antibody SnugDock Case study","title":"Apply: Sigmoid Model -- Pnear Folding Funnel","text":"case study, can look real score-vs-rmsd plots Antibody SnugDock scientific benchmark. evaluates SnugDock protocol 6 Antibody protein targets can use fit sigmoid model log(RMSD) using BayesPharma package, relies BRMS Stan Check model parameter fit estimated parameters: Excitingly, using leave-one-cross-validation, sigmoid model fits data well Visualize fit draws expected mean median quantile intvervals log(RMSD) scale: plot chunk plot-data-model original RMSD scale: plot chunk plot-data-model-rmsd","code":"##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: response ~ sigmoid(ec50, hill, top, bottom, log_dose)  ##          ec50 ~ 0 + target ##          hill ~ 0 + target ##          top ~ 0 + target ##          bottom ~ 0 + target ##    Data: data (Number of observations: 3003)  ##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; ##          total post-warmup draws = 8000 ##  ## Population-Level Effects:  ##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## ec50_target1ahw       1.70      0.11     1.44     1.86 1.00     4480     2619 ## ec50_target1jps       1.37      0.13     1.08     1.59 1.00     3326     3002 ## ec50_target1mlc       2.40      0.50     1.10     3.18 1.00     3209     2260 ## ec50_target1ztx       0.75      0.08     0.59     0.89 1.00     3795     3796 ## ec50_target2aep       1.13      0.39     0.60     1.60 1.01     1434      413 ## ec50_target2jel       1.65      0.06     1.53     1.76 1.00     5303     4378 ## hill_target1ahw       1.69      0.44     0.90     2.62 1.00     3395     2143 ## hill_target1jps       1.50      0.36     0.89     2.32 1.00     3134     3214 ## hill_target1mlc       1.04      0.56     0.26     2.34 1.00     3608     3501 ## hill_target1ztx       2.74      0.55     1.79     3.95 1.00     5279     4769 ## hill_target2aep       1.97      0.68     0.61     3.33 1.00     1030      365 ## hill_target2jel       3.19      0.59     2.09     4.39 1.00     6304     5194 ## top_target1ahw      -10.56      0.69   -11.57    -8.89 1.00     4469     2908 ## top_target1jps       -9.69      0.59   -10.61    -8.28 1.00     4565     3218 ## top_target1mlc       -1.28      5.95    -9.87    12.57 1.00     5597     4983 ## top_target1ztx      -17.45      0.27   -17.96   -16.93 1.00     9519     6062 ## top_target2aep      -16.14      1.61   -16.96   -14.96 1.01     1095      316 ## top_target2jel      -11.09      0.33   -11.74   -10.44 1.00     9532     5667 ## bottom_target1ahw   -25.98      2.10   -31.41   -23.07 1.00     3767     2052 ## bottom_target1jps   -30.51      3.69   -39.47   -25.05 1.00     2992     2724 ## bottom_target1mlc   -18.34      4.07   -30.38   -14.74 1.00     3115     2455 ## bottom_target1ztx   -38.73      3.43   -46.49   -33.05 1.00     4061     3747 ## bottom_target2aep   -30.20      5.82   -43.09   -21.02 1.00     4166     3031 ## bottom_target2jel   -19.48      0.98   -21.59   -17.75 1.00     5535     4735 ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma     5.74      0.07     5.60     5.89 1.00    10800     6007 ##  ## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1). ##  ## Computed from 8000 by 3003 log-likelihood matrix ##  ##          Estimate   SE ## elpd_loo  -9521.4 39.0 ## p_loo        21.4  1.2 ## looic     19042.7 78.0 ## ------ ## Monte Carlo SE of elpd_loo is 0.1. ##  ## All Pareto k estimates are good (k < 0.5). ## See help('pareto-k-diagnostic') for details."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/apply_sigmoid_model_Pnear.html","id":"quantify-pnear-uncertainty","dir":"Articles","previous_headings":"Antibody SnugDock Case study","what":"Quantify Pnear uncertainty","title":"Apply: Sigmoid Model -- Pnear Folding Funnel","text":"Using two-state model fit, possible propagate posterior uncertainty estimate uncertainty Pnear.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_MuSyC_model.html","id":"sec-MuSyC","dir":"Articles","previous_headings":"","what":"MuSyC synergy model","title":"Derive: MuSyC Model -- Synergy Analysis","text":"two different treatments combined may interact. end-point assays, response stronger weaker expected additive model, treatments said epistatic. sigmoidal dose-response models, however, analysis may complicated. One drug may may shift maximal response (efficacy) , may also shift effective dose shape response (potency). Historically range models proposed capture different aspects synergy, example Bliss independence(Bliss 1956) Loewe additivity(Loewe 1926) null-models synergistic efficacy potency, respectively. SynergyFinder R package(Ianevski, Giri, Aittokallio 2022) synergy python package(Wooten Albert 2021) can used visualize treatment interactions, compute range synergy scores, test interactions significant. Recently Meyer et al.(Meyer et al. 2019, Wooten2021–lg) derived integrated functional synergistic sigmoidal dose-response, Loewe Bliss models special cases. implemented Bayesian model-fitting strategy Matlab, maximum likelihood model-fitting synergy python package. make model accessible pharmacology community, section, briefly review MuSyC functional form, describe Bayesian implementation Stan/BRMS, illustrate using model re-analyze drugs voltage may interact modulate current potassium channel.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_MuSyC_model.html","id":"musyc-functional-form","dir":"Articles","previous_headings":"MuSyC synergy model","what":"MuSyC Functional Form","title":"Derive: MuSyC Model -- Synergy Analysis","text":"functional form MuSyC model gives equation response \\(\\color{brown}{E_d}\\) doses \\(\\color{teal}{d_1}\\) \\(\\color{teal}{d_2}\\) two treatments \\(9\\) free parameters \\(\\color{purple}{C_1}\\), \\(\\color{purple}{C_2}\\), \\(\\color{brown}{E_0}\\), \\(\\color{brown}{E_1}\\), \\(\\color{brown}{E_2}\\), \\(\\color{brown}{E_3}\\), \\(\\color{purple}{h_1}\\), \\(\\color{purple}{h_2}\\), \\(\\color{purple}{\\alpha}\\): \\[\\begin{align} \\color{brown}{E_d} &= \\frac{           {\\color{purple}{C_1}}^{\\color{purple}{h_1}}{\\color{purple}{C_2}}^{\\color{purple}{h_2}}{\\color{brown}{E_0}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}{\\color{purple}{C_2}}^{\\color{purple}{h_2}}{\\color{brown}{E_1}} +           {\\color{purple}{C_1}}^{\\color{purple}{h_1}}{\\color{teal}{d_2}}^{\\color{purple}{h_2}}{\\color{brown}{E_2}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}{\\color{teal}{d_2}}^{\\color{purple}{h_2}}{\\color{purple}{\\alpha}} {\\color{brown}{E_3}}        }{           {\\color{purple}{C_1}}^{\\color{purple}{h_1}}{\\color{purple}{C_2}}^{\\color{purple}{h_2}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}{\\color{purple}{C_2}}^{\\color{purple}{h_2}} +           {\\color{purple}{C_1}}^{\\color{purple}{h_1}}{\\color{teal}{d_2}}^{\\color{purple}{h_2}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}{\\color{teal}{d_2}}^{\\color{purple}{h_2}}{\\color{purple}{\\alpha}}} \\end{align}\\] interpret parameters set \\(\\color{teal}{d_2}=0\\), \\[\\begin{align} \\color{brown}{E_d} &= \\frac{           {\\color{purple}{C_1}}^{\\color{purple}{h_1}}{\\color{brown}{E_0}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}{\\color{brown}{E_1}}        }{           {\\color{purple}{C_1}}^{\\color{purple}{h_1}} +           {\\color{teal}{d_1}}^{\\color{purple}{h_1}}} \\end{align}\\] Hill equation, modeled \\(\\ref{sec:hill}\\). additionally set \\(\\color{teal}{d_1}=0\\) \\(\\color{brown}{E_d}=\\color{brown}{E_0}\\), limit \\({\\color{teal}{d_1}}\\rightarrow \\infty\\) \\({\\color{brown}{E_d}}\\rightarrow {\\color{brown}{E_1}}\\), \\({\\color{teal}{d_1}}=\\color{purple}{C_1}\\) \\({\\color{brown}{E_d}} = ({\\color{brown}{E_0}} + {\\color{brown}{E_2}})/2\\), half maximal response (either \\(\\color{brown}{\\mbox{IC}_{50}}\\) treatment \\(1\\) inhibitor \\(\\color{brown}{\\mbox{EC}_{50}}\\) treatment \\(1\\) agonist). slope \\({\\color{teal}{d_1}}={\\color{purple}{C_1}}\\) \\[\\begin{align*}     \\frac{\\mathrm{d}\\;\\color{brown}{E_d}}{\\mathrm{d}\\color{teal}{d_1}}         &= {\\color{purple}{C_1}}^{v}{\\color{brown}{E_0}}               \\frac{\\mathrm{d}}{\\mathrm{d}\\color{teal}{d_1}}                   \\frac{1}{{\\color{purple}{C_1}}^{\\color{purple}{h_1}} + {\\color{teal}{d_1}}^{\\color{purple}{h_1}}} +            {\\color{brown}{E_1}}               \\frac{\\mathrm{d}}{\\mathrm{d}\\color{teal}{d_1}}                    \\frac{{\\color{teal}{d_1}}^{h_1}}{{\\color{purple}{C_1}}^{\\color{purple}{h_1}} + {\\color{teal}{d_1}}^{\\color{purple}{h_1}}}\\\\         &= {\\color{purple}{C_1}}^{h_1}{\\color{brown}{E_0}}               \\frac{                          h_1{\\color{teal}{d_1}}^{{\\color{purple}{h_1}}-1}}{\\left({\\color{purple}{C_1}}^{\\color{purple}{h_1}} + {\\color{teal}{d_1}}^{\\color{purple}{h_1}}\\right)^2} +             {\\color{brown}{E_1}}                \\frac{{\\color{purple}{C_1}}^{\\color{purple}{h_1}}h_1{\\color{teal}{d_1}}^{{\\color{purple}{h_1}}-1}}{\\left({\\color{purple}{C_1}}^{\\color{purple}{h_1}} + {\\color{teal}{d_1}}^{\\color{purple}{h_1}}\\right)^2}\\\\         &= ({\\color{brown}{E_0}} + {\\color{brown}{E_1}}) \\end{align*}\\] evaluation functional form \\({\\color{brown}{E_d}}\\) numerically unstable. transform using \\(\\mbox{log\\_sum\\_exp}\\) trick, let \\[\\begin{align*} \\mbox{numerator\\_parts} = [\\\\       &{\\color{purple}{h_1}}\\log({\\color{purple}{C_1}}) + {\\color{purple}{h_2}}\\log({\\color{purple}{C_2}}) + \\log({\\color{brown}{E_0}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{teal}{d_1}}) + {\\color{purple}{h_2}}\\log({\\color{purple}{C_2}}) + \\log({\\color{brown}{E_1}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{purple}{C_1}}) + {\\color{purple}{h_2}}\\log({\\color{teal}{d_2}}) + \\log({\\color{brown}{E_2}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{teal}{d_1}}) + {\\color{purple}{h_2}}\\log({\\color{teal}{d_2}}) + \\log({\\color{brown}{E_3}}) + \\log({\\color{purple}{\\alpha}}) ]\\\\ \\mbox{denominator\\_parts} = [\\\\       &{\\color{purple}{h_1}}\\log({\\color{purple}{C_1}}) + {\\color{purple}{h_2}}\\log({\\color{purple}{C_2}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{teal}{d_1}}) + {\\color{purple}{h_2}}\\log({\\color{purple}{C_2}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{purple}{C_1}}) + {\\color{purple}{h_2}}\\log({\\color{teal}{d_2}}),\\\\       &{\\color{purple}{h_1}}\\log({\\color{teal}{d_1}}) + {\\color{purple}{h_2}}\\log({\\color{teal}{d_2}})]\\\\ \\end{align*}\\] \\[     E_d = \\mbox{exp}\\!\\left(\\mbox{log\\_sum\\_exp}(\\mbox{numerator\\_parts}) - \\mbox{log\\_sum\\_exp}(\\mbox{denominator\\_parts})\\right). \\]","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_MuSyC_model.html","id":"implementation-and-usage-of-the-musyc-model-in-stanbrms","dir":"Articles","previous_headings":"MuSyC synergy model","what":"Implementation and usage of the MuSyC model in Stan/BRMS","title":"Derive: MuSyC Model -- Synergy Analysis","text":"#’ Drug Synergy #’ MuSyC Drug Synergy model #’ #’ Assume response metric decreases effective drugs #’ Let E3 effect maximum concentration drugs #’ #’ #’ Special cases: #’ * dose additive model: alpha1 = alpha2 = 0 #’ * loewe: h1 = h2 = 1 #’ * CI: E0 = 1, E1 = E2 = E3 = 0 #’ drug effect equated percent inhibition #’ * bliss drug independence model: #’ E0 = 1, E1 = E2 = E3 = 0, alpha1 = alpha2 = 1 #’ (param?) d1 Dose drug 1 #’ (param?) d2 Dose drug 2 #’ #’ (param?) E0 effect drug treatment #’ #’ # params drug 1 self #’ (param?) s1 drug 1 hill slope #’ (param?) C1 drug 1 EC50 #’ (param?) E1 drug 1 maximum effect #’ #’ # params drug 2 self #’ (param?) s2 drug 2 hill slope #’ (param?) C2 drug 2 EC50 #’ (param?) E2 drug 2 maximum effect #’ #’ (param?) beta synergistic efficacy #’ percent increase drug combination’s effect #’ beyond efficacious single drug. #’ #’ beta > 0 => synergistic efficacy #’ effect maximum concentration drugs (E3) exceeds #’ maximum effect either drug alone (E1 E2) #’ #’ beta < 0 => antagonistic efficacy #’ least one drugs efficacious #’ single agents combination #’ #’ (param?) alpha1 synergistic potency #’ effective dose drug 1 #’ altered presence drug 2 #’ (param?) alpha2 synergistic potency #’ effective dose drug 2 #’ altered presence drug 1 #’ #’ alpha > 1 => synergistic potency #’ EC50 decreases addition drug, #’ corresponding increase potency #’ #’ 0 <= alpha < 1 => antagonistic potency #’ EC50 drug increases result drug, #’ corresponding decrease potency #’ #’ alpha1 == alpha2 detailed balance #’ (export?) generate_MuSyC_effects <- function( d1, d2, E0, s1, C1, E1, s2, C2, E2, alpha, E3) { h1 <- MuSyC_si_to_hi(s1, C1, E0, E1) h2 <- MuSyC_si_to_hi(s2, C2, E0, E2) numerator <- C1^h1 * C2^h2 * E0 + d1^h1 * C2^h2 * E1 + C1^h1 * d2^h2 * E2 + d1^h1 * d2^h2 * E3 * alpha denominator <- C1^h1 * C2^h2 + d1^h1 * C2^h2 + C1^h1 * d2^h2 + d1^h1 * d2^h2 * alpha numerator / denominator } #’ Create formula MuSyC synergy model #’ #’ (description?) setup defaulMuSyC synergy model formula predict #’ E0, C1, E1, s1, C2, E2, s2, log10alpha, E3alpha #’ parameters. #’ #’ (param?) predictors Additional formula objects specify predictors #’ non-linear parameters. .e. perturbations/experimental differences #’ modeled separately? (Default: 1) random effect taken #’ consideration? .e. cell number, plate number, etc. #’ (return?) brmsformula #’ #’ (examples?) #‘ #’ #’ (export?) MuSyC_formula <- function( predictors = 1, …) { } #’ Fit MuSyC synergy model dose #’ #’ (param?) data data.frame experimental data #’ columns: dose1, dose2, n_positive, count, [] #’ (param?) group_vars quosures list #’ dplyr::vars(…) columns fitting synergy model #’ (param?) C1_prior prior distribution Ed d1=d1_IC50, d2=0 #’ (param?) C2_prior prior distribution Ed d1=0, d2=d2_IC50 #’ (param?) s1_prior prior distribution d(Ed)/d(d1) d1=d1_IC50, d2=0 #’ (param?) s2_prior prior distribution d(Ed)/d(d2) d1=0, d2=d2_IC50 #’ (param?) log10alpha_prior prior distribution alpha synergy parameter #’ (param?) E0_prior prior distribution Ed d1=0, d2=0 #’ (param?) E1_prior prior distribution Ed d1=Inf, d2=0 #’ (param?) E2_prior prior distribution Ed d1=0, d2=Inf #’ (param?) E3_alpha_prior prior distribution Ed scaled alpha d1=Inf, #’ d2=Inf #’ (param?) C1_init initial sampling distribution C1 parameter #’ (param?) C2_init initial sampling distribution C2 parameter #’ (param?) s1_init initial sampling distribution s1 parameter #’ (param?) s2_init initial sampling distribution s2 parameter #’ (param?) log10alpha_init initial sampling distribution alpha parameter #’ (param?) E0_init initial sampling distribution E0 parameter #’ (param?) E1_init initial sampling distribution E1 parameter #’ (param?) E2_init initial sampling distribution E2 parameter #’ (param?) E3_alpha_init initial sampling distribution E3 parameter #’ (param?) combine combine grouped models single brms model #’ (param?) verbose verbose output #’ #’ (param?) iter number stan NUTS sampling steps #’ (param?) cores number cores used sampling #’ (param?) stan_model_args stan model arguments #’ (param?) control stan control arguments #’ #’ #’ #’ bernoulli_inf(n_positive / count) = #’ Ed ~ MuSyC(d1, d2, C_params, E_params, s_params, alpha) #’ #’ improve numeric stability, d1 d2 C1 C2 variables #’ scaled improve numeric stability: #’ #’ d1 = dose1/max(dose1) #’ d2 = dose2/max(dose2) #’ drug1_IC50 = C1 * max(dose1) #’ drug2_IC50 = C2 * max(dose2) #’ #’ Functional form: #’ Ed ~ ( #’ C1^h1 * C2^h2 * E0 + #’ d1^h1 * C2^h2 * E1 + #’ C1^h1 * d2^h2 * E2 + #’ d1^h1 * d2^h2 * E3 * alpha #’ ) / ( #’ C1^h1 * C2^h2 + #’ d1^h1 * C2^h2 + #’ C1^h1 * d2^h2 + #’ d1^h1 * d2^h2 * alpha #’ ) #’ #’ #’ #’ #’ #’ ############################################## #’ # Proof definitions parameters # #’ ############################################## #’ #’ Claim: d1=0 d2=0 Ed = E0 #’ Ed = (C1^h1 * C2^h2 * E0) / (C1^h1 * C2^h2) #’ = E0 #’ #’ Claim: d1=0 d2 -> Inf Ed = E2 #’ Ed = (C2^h2 * E0 + d2^h2 * E2) / (C2^h2 + d2^h2) #’ = (d2^h2 * E2) / (d2^h2) #’ = E2 #’ #; Claim: d1=0 d2=C2 Ed = (E0 + E2) / 2 #’ d1>0 d2 -> Inf Ed #’ Ed = (C1^h1 * C2^h2 * E0 + C1^h1 * C2^h2 * E2) / #’ (C1^h1 * C2^h2 + C1^h1 * C2^h2) #’ = (E0 + E2) / 2 #’ #’(export?) MuSyC_model <- function( data, group_vars = vars(compound), formula = MuSyC_formula(), prior = MuSyC_prior(), init = MuSyC_init(), combine = FALSE, verbose = FALSE, iter = 8000, cores = 4, stan_model_args = list(verbose = FALSE), control = list( adapt_delta = .99, max_treedepth = 12), model_evaluation_criteria = c(“loo”, “bayes_R2”), …) { (.data.frame(well_scores)) { grouped_data <- well_scores |> dplyr::group_by(!!!group_vars) |> dplyr::mutate( d1_scale_factor = max(dose1), d2_scale_factor = max(dose2)) |> tidyr::nest() |> dplyr::ungroup() } (verbose) { cat(“Fitting MuSyC model”) } model <- brms::brm_multiple( formula = formula, data = grouped_data$data, family = binomial(“identity”), prior = prior, init = init, # stanvars = c( # brms::stanvar( # scode = ” real d1_scale_factor = max(dose1));“, # block =”tdata”, # position = “end”), # brms::stanvar( # scode = ” real d2_scale_factor = max(dose2));“, # block =”tdata”, # position = “end”), # brms::stanvar( # scode = ” real drug1_IC50 = b_C1 * d1_scale_factor);“, # block =”genquant”, # position = “end”), # brms::stanvar( # scode = ” real drug2_IC50 = b_C2 * d2_scale_factor;“, # block =”genquant”, # position = “end”)), combine = FALSE, data2 = NULL, iter = iter, cores = cores, stan_model_args = stan_model_args, control = control, …) (!.null(model_evaluation_criteria)) { # evaluate fits model <- model |> purrr::imap(function(model, ) { group_index <- grouped_data[, ] |> dplyr::select(-data) group_index_label <- paste0( names(group_index), “:”, group_index, collapse = “,”) cat(“Evaluating model fit ”, group_index_label, “…”, sep = ““) model <- model |> brms::add_criterion( criterion = model_evaluation_criteria, model_name = paste0(”MuSyC:“, group_index_label), reloo = TRUE) model }) } grouped_data |> dplyr::mutate( model = model) }","code":"predictor_eq <- rlang::new_formula(   lhs = quote(E0 + C1 + E1 + s1 + C2 + E2 + s2 + log10alpha + E3alpha),   rhs = rlang::enexpr(predictors))  brms::brmsformula(   response ~ (C1^h1 * C2^h2 * E0 +       d1^h1 * C2^h2 * E1 +       C1^h1 * d2^h2 * E2 +       d1^h1 * d2^h2 * E3alpha     ) / (       C1^h1 * C2^h2 +       d1^h1 * C2^h2 +       C1^h1 * d2^h2 +       d1^h1 * d2^h2 * 10^log10alpha),   brms::nlf(d1 ~ dose1 / d1_scale_factor),   brms::nlf(d2 ~ dose2 / d2_scale_factor),   brms::nlf(h1 ~ s1 * (4 * C1) / (E0 + E1)),   brms::nlf(h2 ~ s2 * (4 * C2) / (E0 + E2)),   predictors_eq,   nl = TRUE,   ...)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"enzyme-kinetic-modeling","dir":"Articles","previous_headings":"","what":"Enzyme Kinetic Modeling","title":"Derive: tQ Model -- Enzyme Kinetics","text":"Enzymes proteins catalyze chemical reactions. facilitate producing virtual biological matter, crucial regulating biological processes. early 20th century Michaelis Menten described foundational kinematic model enzymes, substrate enzyme reversibly bind, substrate converted product released. free enzyme (E) reversibly binds stubstrate (S) form complex (C) forward backward rate constants kf kb, irreversibly catalyzed product (P), rate constant kcat, releasing enzyme catalyze additional substrate. total enzyme concentration defined ET := E + C. total substrate product concentration defined ST := S + C + P. Michaelis constant defined kM := (kb + kcat) / kf. kcat rate constant determines maximum turn saturating substrate concentrations, Vmax := kcat * ET. rate constants kcat kM can estimated monitoring product accumulation time (enzyme progress curves), varying enzyme substrate concentrations. assuming enzyme concentration low (ET << ST), derived celebrated Michaelis-Menten kinetics. Since work, number groups developed models enzyme kinetics make less stringent assumptions. Recently (Choi, et al., 2017), described Bayesian model total QSSA model. make model accessible, re-implemented Stan/BRMS framework made available BayesPharma package.","code":"kf              --->     kcat       E + S  <---  C --->  E + P               kb"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"outline-for-vignette","dir":"Articles","previous_headings":"","what":"Outline for Vignette","title":"Derive: tQ Model -- Enzyme Kinetics","text":"Next formally define problem formulate model solution ordinary differential equation. illustrate, consider toy system assuming kcat kM known simulate sequence measurements using deSolve. implement ODE Stan/BRMS using stanvars show parameters toy system can estimated. Since common vary enzyme substrate concentrations order better estimate kinematic parameters, show can improve Stan/BRMS model allow multiple observations, arbitrary number measurements. finally, consider real enzyme kinetics data set use Stan/BRMS model estimate kinematic parameters. compare estimated parameters fit using standard approaches.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"problem-statement","dir":"Articles","previous_headings":"","what":"Problem Statement","title":"Derive: tQ Model -- Enzyme Kinetics","text":"Implement total QSSA model stan/BRMS, refinement classical Michaelis-Menten enzyme kinetics ordinary differential equation described (Choi, et al., 2017, DOI: 10.1038/s41598-017-17072-z). equation 2: (Choi, et al. 2017) prove, tQ model valid K = kb/kf dissociation constant.","code":"Observed data:   M     = number of measurements # The product concentration Pt is measured   t[M]  = time                   # at M time points t   Pt[M] = product                #    ST    = substrate total conc.  # Substrate and enzyme concentrations are   ET    = enzyme total conc.     # assumed to be given for each observation  Model parameters:   kcat    # catalytic constant   kM      # Michaelis constant  ODE formulation:   dPdt = kcat * (                # Change in product concentration at time t     ET + kM + ST - Pt +               -sqrt((ET + kM + ST - Pt)^2 - 2* ET * (ST - Pt))) / 2   initial condition:     P := 0                       # There is zero product at time 0 K/(2*ST) * (ET+kM+ST) / sqrt((ET+kM+ST+P)^2 - 4*ET(ST-P)) << 1,"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"simulate-one-observation","dir":"Articles","previous_headings":"","what":"Simulate one observation","title":"Derive: tQ Model -- Enzyme Kinetics","text":"Using deSolve package can simulate data following total QSSA model. Measurements made random Gaussian noise mean 0 variance 0.5. visualize, true enzyme progress curve shown blue, enzyme progress curve fit noisy measurements smooth loess spline shown orange. smooth fits well, estimate parameters curve . plot chunk data-single-plot","code":"tQ_model_generate <- function(time, kcat, kM, ET, ST){   ode_tQ <- function(time, Pt, theta){     list(c(theta[1] * (       ET + theta[2] + ST - Pt +       -sqrt((ET + theta[2] + ST - Pt)^2 - 4 * ET * (ST - Pt))) / 2))   }   deSolve::ode(y = 0, times = time, func = ode_tQ, parms = c(kcat, kM)) }  data_single <- tQ_model_generate(   time = seq(0.00, 3, by=.05),   kcat = 3,   kM = 5,   ET = 10,   ST = 10) |>   as.data.frame() |>   dplyr::rename(P_true = 2) |>   dplyr::mutate(     P = rnorm(dplyr::n(), P_true, 0.5), # add some observational noise     ST = 10, ET = 10) head(data_single) ##   time    P_true         P ST ET ## 1 0.00 0.0000000 0.4799215 10 10 ## 2 0.05 0.7311578 0.7939460 10 10 ## 3 0.10 1.4243598 2.6459084 10 10 ## 4 0.15 2.0794197 1.2737768 10 10 ## 5 0.20 2.6964485 3.2691204 10 10 ## 6 0.25 3.2758537 4.0948480 10 10 ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"fitting-a-single-ode-observation-in-brms","dir":"Articles","previous_headings":"","what":"Fitting a single ODE observation in BRMS","title":"Derive: tQ Model -- Enzyme Kinetics","text":"implement BRMS, can use stanvars define custom functions. key idea call ODE solver, case backward differentiation formula (bdf) used solve stiff ODEs, passing function ode_tQ returns dP/dt, change product time t. ode_tQ function depends product time t state vector, kinematic parameters estimated kcat kM user-provided data enzyme substrate concentrations ET ST. call ode_dbf pass initial product concentration time (equal zero), measured time-points, parameters user defied data. Finally , extract vector sampled vector product concentrations return. use function, define kcat kM parameters wish sample P ~ tQ(...). Since data points define single observation, set loop = FALSE. use gamma priors kcat kM shape parameter alpha=4 rate parameter beta=1. prior mean alpha/beta = 4/1 = 4 variance alpha/beta^2 = 4/1 = 4. also bound parameters 0. initialize chain prior mean use cmdstanr version 2.29.2 backend, use default warmup 1000 Fitting model takes ~15 seconds, Rhat = 1 effective sample size bulk tail greater 1400 parameters. estimates 95% confidence intervals good. visualize posterior distribution vs. prior distribution, first sample prior, using brms::brm call sample_prior = \"\" argument. plot, use tidybayes gather draws ggplot2 map curves, prior theorange curve, posterior blue curve, true parameter marked vertical line. plot chunk prior-posterior-single-marginal-plot plot chunk prior-posterior-single-scatter","code":"stanvars_tQ_ode <- brms::stanvar(scode = paste(\" vector tQ_ode(    real time,    vector state,    vector params,    data real ET,    data real ST) {        real Pt = state[1];   // product at time t    real kcat = params[1];    real kM = params[2];    vector[1] dPdt;    dPdt[1] = kcat * (      ET + kM + ST - Pt      -sqrt((ET + kM + ST - Pt)^2 - 4 * ET * (ST - Pt))) / 2;    return(dPdt); } \", sep = \"\\n\"), block = \"functions\") stanvars_tQ_single <- brms::stanvar(scode = paste(\" vector tQ_single(   data vector time,   vector vkcat,   vector vkM,   data vector vET,   data vector vST) {      vector[2] params = [ vkcat[1], vkM[1] ]';   vector[1] initial_state = [ 0.0 ]';   real initial_time = 0.0;   int M = dims(time)[1];    vector[1] P_ode[M] = ode_bdf(     // Function signature:     tQ_ode,                         // function ode     initial_state,                  // vector initial_state     initial_time,                   // real initial_time     to_array_1d(time),              // array[] real time     params,                         // vector params     vET[1],                         // ...     vST[1]);                        // ...      vector[M] P;                      // Need to return a vector not array   for(i in 1:M) P[i] = P_ode[i,1];   return(P); } \", sep = \"\\n\"), block = \"functions\") brms_params <- list(   cores = 4,   seed = 52L,   backend = 'cmdstanr') model_single <- do.call(what = brms::brm, args = c(list(   formula = brms::brmsformula(     P ~ tQ_single(time, kcat, kM, ET, ST),     kcat + kM ~ 1,     nl = TRUE,     loop=FALSE),   data = data_single |> dplyr::filter(time > 0),   prior = c(     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kcat\"),     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kM\")),   init = function() list(kcat = 4, kM = 4),   stanvars = c(     stanvars_tQ_ode,     stanvars_tQ_single)),   brms_params)) ## ld: warning: duplicate -rpath '/Users/maom/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb' ignored ## Start sampling ## Init values were only set for a subset of parameters.  ## Missing init values for the following parameters: ##  - chain 1: b_kcat, b_kM, sigma ##  - chain 2: b_kcat, b_kM, sigma ##  - chain 3: b_kcat, b_kM, sigma ##  - chain 4: b_kcat, b_kM, sigma ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d15dcb311.stan', line 65, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d15dcb311.stan', line 65, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 3 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d15dcb311.stan', line 65, column 2 to column 38) ## Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 3 ## Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 4 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d15dcb311.stan', line 65, column 2 to column 38) ## Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 4 ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: P ~ tQ_single(time, kcat, kM, ET, ST)  ##          kcat ~ 1 ##          kM ~ 1 ##    Data: structure(list(time = c(0.05, 0.1, 0.15, 0.2, 0.25 (Number of observations: 60)  ##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; ##          total post-warmup draws = 4000 ##  ## Population-Level Effects:  ##                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## kcat_Intercept     2.87      0.42     2.17     3.81 1.00     1301     1535 ## kM_Intercept       4.27      1.92     1.35     8.71 1.00     1282     1439 ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma     0.51      0.05     0.43     0.62 1.00     1703     1668 ##  ## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1). model_single_prior <- do.call(what = brms::brm, args = c(list(   formula = brms::brmsformula(     P ~ tQ_single(time, kcat, kM, ET, ST),     kcat + kM ~ 1,     nl = TRUE,     loop=FALSE),   data = data_single |> dplyr::filter(time > 0),   prior = c(     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kcat\"),     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kM\")),   init = function() list(kcat = 4, kM = 4),   stanvars = c(     stanvars_tQ_ode,     stanvars_tQ_single),   sample_prior = \"only\"),   brms_params)) ## ld: warning: duplicate -rpath '/Users/maom/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb' ignored ## Start sampling ## Init values were only set for a subset of parameters.  ## Missing init values for the following parameters: ##  - chain 1: b_kcat, b_kM, sigma ##  - chain 2: b_kcat, b_kM, sigma ##  - chain 3: b_kcat, b_kM, sigma ##  - chain 4: b_kcat, b_kM, sigma"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/derive_tQ_model.html","id":"fitting-multiple-observations","dir":"Articles","previous_headings":"","what":"Fitting multiple observations","title":"Derive: tQ Model -- Enzyme Kinetics","text":"Next extend BRMS model allow fitting common kcat, kM concentrations based multiple replicas, varying substrate/enzyme concentrations using BRMS. demonstrate, varying enzyme substrate concentrations, better fit kinematic parameters. plot chunk data-multiple-plot plot chunk prior-posterior-multiple-scatter Next sample enzyme progress curves posterior plot chunk model-multiple-curves","code":"data_multiple <- tidyr::expand_grid(   kcat = 3,   kM =  5,   ET = c(3, 10, 30),   ST = c(3, 10, 30)) |>   dplyr::mutate(observation_index = dplyr::row_number()) |>   dplyr::rowwise() |>   dplyr::do({     data <- .     time <- seq(0.05, 3, by=.05)     data <- data.frame(data,       time = time,       P = tQ_model_generate(         time = time,         kcat = data$kcat,         kM = data$kM,         ET = data$ET,         ST = data$ST)[,2])   }) |>   dplyr::mutate(     P = rnorm(dplyr::n(), P, 0.5)) stanvars_tQ_multiple <- brms::stanvar(scode = paste(\" vector tQ_multiple(   array[] int replica,   data vector time,   vector vkcat,   vector vkM,   data vector vET,   data vector vST) {    int N = size(time);   vector[N] P;   int begin = 1;   int current_replica = replica[1];   for (i in 1:N){     if(current_replica != replica[i]){       P[begin:i-1] = tQ_single(         time[begin:i-1],         vkcat,         vkM,         vET[begin:i-1],         vST[begin:i-1]);       begin = i;       current_replica = replica[i];     }   }   P[begin:N] = tQ_single(time[begin:N], vkcat, vkM, vET[begin:N], vST[begin:N]);   return(P); }\", sep = \"\\n\"), block = \"functions\") model_multiple <- do.call(what = brms::brm, args = c(list(   formula = brms::brmsformula(     P ~ tQ_multiple(observation_index, time, kcat, kM, ET, ST),     kcat + kM ~ 1,     nl = TRUE,     loop=FALSE),   data = data_multiple,   prior = c(     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kcat\"),     brms::prior(prior = gamma(4, 1), lb = 0, nlpar = \"kM\")),   init = function() list(kcat = 4, kM = 4),   stanvars = c(     stanvars_tQ_ode,     stanvars_tQ_single,     stanvars_tQ_multiple)),   brms_params)) ## ld: warning: duplicate -rpath '/Users/maom/.cmdstan/cmdstan-2.32.2/stan/lib/stan_math/lib/tbb' ignored ## Start sampling ## Init values were only set for a subset of parameters.  ## Missing init values for the following parameters: ##  - chain 1: b_kcat, b_kM, sigma ##  - chain 2: b_kcat, b_kM, sigma ##  - chain 3: b_kcat, b_kM, sigma ##  - chain 4: b_kcat, b_kM, sigma ## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 1 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 1 ## Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 1 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 104, column 4 to column 41) ## Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 1 ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 2 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 2 ## Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 3 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 3 ## Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 3 Exception: gamma_lpdf: Random variable[1] is 0, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 3 ## Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 3 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 3 ## Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 3 Exception: Exception: Exception: CVode(cvodes_mem, t_final, nv_state_, &t_init, CV_NORMAL) failed with error flag -4: ## Chain 3 Convergence test failures occurred too many times during one internal time step or minimum step size was reached. (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 23, column 4 to line 33, column 47) (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 50, column 8 to line 52, column 45) (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 103, column 4 to column 59) ## Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 3 ## Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 4 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 4 ## Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: ## Chain 4 Exception: gamma_lpdf: Random variable[1] is inf, but must be positive finite! (in '/var/folders/w2/kpys2s194q381xp3_knz9bgc0000gs/T/Rtmpi2mqgp/model-184d125eab912.stan', line 86, column 2 to column 38) ## Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, ## Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. ## Chain 4 model_multiple ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: P ~ tQ_multiple(observation_index, time, kcat, kM, ET, ST)  ##          kcat ~ 1 ##          kM ~ 1 ##    Data: structure(list(kcat = c(3, 3, 3, 3, 3, 3, 3, 3, 3, (Number of observations: 540)  ##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; ##          total post-warmup draws = 4000 ##  ## Population-Level Effects:  ##                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## kcat_Intercept     2.78      0.04     2.70     2.87 1.00     1481     1388 ## kM_Intercept       4.44      0.31     3.86     5.09 1.00     1475     1440 ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma     0.60      0.02     0.57     0.64 1.00     1986     1783 ##  ## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS ## and Tail_ESS are effective sample size measures, and Rhat is the potential ## scale reduction factor on split chains (at convergence, Rhat = 1). ## Start sampling ## Init values were only set for a subset of parameters.  ## Missing init values for the following parameters: ##  - chain 1: b_kcat, b_kM, sigma ##  - chain 2: b_kcat, b_kM, sigma ##  - chain 3: b_kcat, b_kM, sigma ##  - chain 4: b_kcat, b_kM, sigma"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/articles/implement_tidymodels.html","id":"using-bayespharma-models-with-tidymodels","dir":"Articles","previous_headings":"","what":"Using BayesPharma models with Tidymodels","title":"Implement: BayesPharma and Tidymodels","text":"Tidymodels platform running analyzing models R. vignette demonstrates use BayesPharma models Tidy Models. Define recipe assign roles different columns Define model using wrapper package Tidymodels. Build run workflow adding recipe model running fit.","code":"load(here::here(\"data\", \"kor_antag.rda\")) kor_antag <- kor_antag |> dplyr::transmute(   substance_id = Drug,   cell_id = cell_number,   log_dose = log_dose,   response = normalized_measurement) kor_recipe <- kor_antag |>   recipes::recipe() |>   recipes::update_role(response, new_role = \"outcome\") |>   recipes::update_role(log_dose, new_role = \"predictor\") |>   recipes::update_role(substance_id, new_role = \"predictor\") kor_model <- bayesian::bayesian(   cores = 4,   chains = 4,   iter = 2000,   control = list(adapt_delta = 0.99),   stanvars = BayesPharma::sigmoid_stanvar(),   init = BayesPharma::sigmoid_antagonist_init(top = 100),   prior = BayesPharma::sigmoid_antagonist_prior(top = 100)) |>   parsnip::set_engine(\"brms\") |>   parsnip::set_mode(\"regression\") |>   recipes::update(     formula.override = bayesian::bayesian_formula(       ..y ~ sigmoid(ic50, hill, top, bottom, log_dose),       ic50 + hill + top + bottom ~ 0 + substance_id,       nl = TRUE)) kor_workflow <- workflows::workflow() |>   workflows::add_recipe(kor_recipe) |>   workflows::add_model(spec = kor_model) |>   parsnip::fit(data = kor_antag) ## Compiling Stan program... ## Start sampling kor_workflow ## ══ Workflow [trained] ══════════════════════════════════════════════════════════════════════════════════════════════════ ## Preprocessor: Recipe ## Model: bayesian() ##  ## ── Preprocessor ──────────────────────────────────────────────────────────────────────────────────────────────────────── ## 0 Recipe Steps ##  ## ── Model ─────────────────────────────────────────────────────────────────────────────────────────────────────────────── ##  Family: gaussian  ##   Links: mu = identity; sigma = identity  ## Formula: ..y ~ sigmoid(ic50, hill, top, bottom, log_dose)  ##          ic50 ~ 0 + substance_id ##          hill ~ 0 + substance_id ##          top ~ 0 + substance_id ##          bottom ~ 0 + substance_id ##    Data: ~data (Number of observations: 73)  ##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; ##          total post-warmup draws = 4000 ##  ## Population-Level Effects:  ##                                Estimate Est.Error l-95% CI u-95% CI Rhat ## ic50_substance_idBTRX_335140      -8.85      0.19    -9.20    -8.42 1.00 ## ic50_substance_idBTRX_395750      -8.21      0.46    -8.92    -7.31 1.00 ## ic50_substance_idJNJ              -9.14      0.32    -9.78    -8.51 1.00 ## ic50_substance_idPF               -6.14      1.06    -7.67    -3.39 1.00 ## hill_substance_idBTRX_335140      -1.46      0.60    -2.88    -0.59 1.00 ## hill_substance_idBTRX_395750      -0.89      0.51    -2.20    -0.23 1.00 ## hill_substance_idJNJ              -0.99      0.50    -2.31    -0.41 1.00 ## hill_substance_idPF               -0.31      0.24    -0.87    -0.03 1.00 ## bottom_substance_idBTRX_335140     0.01      0.50    -0.99     0.98 1.00 ## bottom_substance_idBTRX_395750     0.01      0.51    -0.98     0.99 1.00 ## bottom_substance_idJNJ            -0.00      0.50    -1.00     0.99 1.00 ## bottom_substance_idPF             -0.00      0.50    -0.98     0.97 1.00 ## top_substance_idBTRX_335140      100.00      0.00   100.00   100.00   NA ## top_substance_idBTRX_395750      100.00      0.00   100.00   100.00   NA ## top_substance_idJNJ              100.00      0.00   100.00   100.00   NA ## top_substance_idPF               100.00      0.00   100.00   100.00   NA ##                                Bulk_ESS Tail_ESS ## ic50_substance_idBTRX_335140       4061     2264 ## ic50_substance_idBTRX_395750       2239     1044 ## ic50_substance_idJNJ               3939     2606 ## ic50_substance_idPF                2289     1435 ## hill_substance_idBTRX_335140       4018     3195 ## hill_substance_idBTRX_395750       2344     1262 ## hill_substance_idJNJ               4884     3233 ## hill_substance_idPF                1856     1474 ## bottom_substance_idBTRX_335140     4951     2833 ## bottom_substance_idBTRX_395750     5480     2896 ## bottom_substance_idJNJ             5218     2544 ## bottom_substance_idPF              5071     2943 ## top_substance_idBTRX_335140          NA       NA ## top_substance_idBTRX_395750          NA       NA ## top_substance_idJNJ                  NA       NA ## top_substance_idPF                   NA       NA ##  ## Family Specific Parameters:  ##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS ## sigma    32.09      2.86    27.14    38.46 1.00     4192     2983 ##  ## ... ## and 4 more lines."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Madeline Martin. Author. Matthew O'Meara. Author, maintainer.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Martin M, O'Meara M (2023). BayesPharma: Tools Bayesian Analysis Non-Linear Pharmacology Models. R package version 0.0.3, https://maomlab.github.io/BayesPharma/.","code":"@Manual{,   title = {BayesPharma: Tools for Bayesian Analysis of Non-Linear Pharmacology Models},   author = {Madeline Martin and Matthew O'Meara},   year = {2023},   note = {R package version 0.0.3},   url = {https://maomlab.github.io/BayesPharma/}, }"},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"BayesPharma package contains collection R tools analyzing pharmacology data using Bayesian statistics modeling. comparison likelihood-based inference, BayesPharma builds stan ecosystem brms package. BayesPharma facilitates applying principled Bayesian workflow fit analyze several foundational pharmacology models, dose-response modeling, modeling Pnear folding funnels molecular modeling, modeling potential docking ‘hit-rate’ curves function dock score ultra-large library docking (Lyu et al. (2019), Alon et al. (2021)).","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"pre-requisites","dir":"","previous_headings":"Installation","what":"Pre-requisites","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"Follow instructions install rstan","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"install-bayespharma","dir":"","previous_headings":"Installation","what":"Install BayesPharma","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"R ","code":"install.packages(\"remotes\") remotes::install_github(\"maomlab/BayesPharma\")"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"predictor columns typically treatment variables like drug batch variable like well_id. use model , example fit sigmoid agonist model:","code":"library(tidyverse) library(BayesPharma)  data <- data.frame(   response = ...,   treatment = ...,   <predictor columns>) model <- BayesPharma::sigmoid_model(    data = data,    formula = BayesPharma::sigmoid_agoinst_formula(),    prior = BayesPharma::sigmoid_agonsit_prior(),    init = BayesPharma::sigmoid_agonist_init())"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"evaluate-model-fit","dir":"","previous_headings":"Usage","what":"Evaluate model fit","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"model fit, evaluate ","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"traceplot","dir":"","previous_headings":"Usage > Evaluate model fit","what":"Traceplot","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model |> BayesPharma::traceplot()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"basic-statistics","dir":"","previous_headings":"Usage > Evaluate model fit","what":"Basic statistics","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model |> posterior::summarize_draws()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"regression-plot","dir":"","previous_headings":"Usage > Evaluate model fit","what":"Regression plot","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model |> BayesPharma::plot_posterior_draws()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"prior-densities","dir":"","previous_headings":"Usage > Evaluate model fit","what":"Prior densities","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model |> BayesPharma::density_distributions() model |> BayesPharma::posterior_densities() model |> BayesPharma::prior_posterior_densities()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"posterior-predictive-check","dir":"","previous_headings":"Usage > Evaluate model fit","what":"posterior predictive check","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model |> brms::pp_check(type = \"dens_overlay\", ndraws = 50)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/index.html","id":"compare-model-fits","dir":"","previous_headings":"Usage","what":"compare model fits","title":"Tools for Bayesian Analysis of Non-Linear Pharmacology Models","text":"","code":"model <- model |> brms::add_loo_criterion() model_fit_comparison <- brms::compare_models(model, model_alt)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/BayesPharma-package.html","id":null,"dir":"Reference","previous_headings":"","what":"BayesPharma: Tools for Bayesian Analysis of Non-Linear Pharmacology Models — BayesPharma-package","title":"BayesPharma: Tools for Bayesian Analysis of Non-Linear Pharmacology Models — BayesPharma-package","text":"BayesPharma package builds Stan brms provide support Bayesian regression modeling foundational pharmacology models. model type, user provides formula: Describing model parameters, treatment, optional predictors lead measured response using functions provided BayesPharma model type. observed data: response, treatment, optional predictors data.frame prior: Initial distributions model parameters models BayesPharma support sigmoid_model: 4-parameter Hill equation MuSyC_model: Bivariate synergy model Bliss Loewe interaction models special cases michaelis_menten_model: Michaelis Menten enzyme kinetics ordinary differential equation model tQ_model: Generalization enzyme progress curve kinetics ordinary differential equation growth_sigmoid_model: Sigmoid model growth kinetics growth_richards_model: Generalized Richards model growth kinetics BayesPharma package also provides range case studies templates examples getting started applying Bayesian modeling pharmacology data analysis. Building rstan::stan brings performance stability -U-Turn Sampling (NUTs) Hamiltonian Monte Carlo whole ecosystem tools model assessment, visualization (see https://mc-stan.org/). Building brms allows compact formula based model specification adding complexity model incrementally, including handling missing data, measurement error, response distributions (see https://paul-buerkner.github.io/brms/).","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","title":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","text":"Generate MuSyC Ed Scores Using Robust Functional Form","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","text":"","code":"MuSyC(logd1, logd2, logE0, logE1, logC1, h1, logE2, logC2, h2, logE3, logalpha)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","text":"logd1 numeric log dose treatment 1 logd2 numeric log dose treatment 2 logE0 numeric Full log response treatment. logE1 numeric Full log response treatment 1 dose treatment 2 zero. logC1 numeric AC50 treatment 1 dose treatment 2 zero. h1 numeric Slope treatment 1 AC50 dose treatment 2 zero exponential form. Use MuSyC_si_to_hi convert slope form. logE2 numeric Full log response treatment 2 dose treatment 1 zero. logC2 numeric AC50 treatment 2 dose treatment 1 zero. h2 numeric Slope treatment 2 AC50 dose treatment 1 zero exponential form. Use MuSyC_si_to_hi convert slope form. logE3 numeric Full response treatment 1 treatment 2. logalpha numeric Log synergistic potency parameter greater 1 synergistic, less 1 antagonistic.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","text":"numeric synergistic response treatment 1 treatment 2 doses logd1 logd2 respectively.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate MuSyC Ed Scores Using a Robust Functional Form — MuSyC","text":"Meyer, D.J., Wooten, D.J., Paudel B.B., Bauer, J., Hardeman, K.N., Westover, D., Lovly, C.M., Harris, L.., Tyson D.R., Quaranta, V., Quantifying Drug Combination Synergy along Potency Efficacy Axes, Cell Syst. 8, 2 (2019). https://doi.org/10.1016/j.cels.2019.01.003 Wooten, D.J., Meyer, C.T., Lubbock, .L.R. et al. MuSyC consensus framework unifies multi-drug synergy metrics combinatorial drug discovery. Nat Commun 12, 4607 (2021). https://doi.org/10.1038/s41467-021-24789-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","title":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","text":"Setup MuSyC synergy model formula predict E0, C1, E1, s1, C2, E2, s2, log10alpha, E3alpha parameters.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","text":"","code":"MuSyC_formula(   treatment_1_variable = \"logd1\",   treatment_1_units = \"Log[Molar]\",   treatment_2_variable = \"logd2\",   treatment_2_units = \"Log[Molar]\",   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","text":"treatment_1_variable character variable representing treatment. treatment_1_units character units treatment. default log base 10 molar concentration treatment_2_variable character variable representing treatment. treatment_2_units character units treatment. default log base 10 molar concentration response_variable character variable representing response treatment response_units character units response predictors formula specify predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? ... additional arguments passed brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","text":"brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Formula for the MuSyC Synergy Model — MuSyC_formula","text":"","code":"if (FALSE) {   # Data has a string column drug_id with drug identifiers   # Fit a separate model for each drug   BayesPharma::MuSyC_formula(predictors = 0 + drug_id)    # Data has a string column plate_id with plate identifiers   # Estimate the change in response for each plate relative to a global   # baseline.   BayesPharma::MuSyC_formula(predictors = plate_id)    # data has columns drug_id and plate_id   # fit a multilevel model where the drug effect depends on the plate   BayesPharma::MuSyC_formula(predictors = 0 + (drug_id|plate_id)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_genquant.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the MuSyC Generated Quantities — MuSyC_genquant","title":"Stan Code for the MuSyC Generated Quantities — MuSyC_genquant","text":"Stan Code MuSyC Generated Quantities","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_genquant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the MuSyC Generated Quantities — MuSyC_genquant","text":"","code":"MuSyC_genquant()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_hi_to_si.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Exponent to Slope Parameterization for Drug i in MuSyC Model — MuSyC_hi_to_si","title":"Convert Exponent to Slope Parameterization for Drug i in MuSyC Model — MuSyC_hi_to_si","text":"can used setting priors interpreting parameter estimates see MuSyC_si_to_hi() details","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_hi_to_si.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Exponent to Slope Parameterization for Drug i in MuSyC Model — MuSyC_hi_to_si","text":"","code":"MuSyC_hi_to_si(hi, Ci, E0, Ei)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_hi_to_si.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Exponent to Slope Parameterization for Drug i in MuSyC Model — MuSyC_hi_to_si","text":"hi numeric value exponent MuSyC equation drug Ci numeric value AC50 drug E0 numeric value response treatments Ei numeric value response infinite drug treatments","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_hi_to_si.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Exponent to Slope Parameterization for Drug i in MuSyC Model — MuSyC_hi_to_si","text":"si slope drug AC50 doses drugs zero","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","title":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","text":"Initial values MuSyC model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","text":"","code":"MuSyC_init(   logE0 = function() runif(n = 1, min = log(0.4), max = log(0.6)),   logC1 = function() runif(n = 1, min = -0.2, max = 0.2),   logE1 = function() runif(n = 1, min = log(0.4), max = log(0.6)),   h1 = function() runif(n = 1, min = 3, max = 5),   logC2 = function() runif(n = 1, min = -0.2, max = 0.2),   logE2 = function() runif(n = 1, min = log(0.4), max = log(0.6)),   h2 = function() runif(n = 1, min = 3, max = 5),   logE3 = function() runif(n = 1, min = log(0.4), max = log(0.6)),   logalpha = function() runif(n = 1, min = -0.2, max = 0.2),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","text":"logE0 numeric function returning array length 1.  Initial value logE0 parameter. Default: log(0.5) logC1 numeric function returning array length 1. Initial value logC1 parameter. Default: 0 = log(1) logE1 numeric function returning array length 1. Initial value logE1 parameter. Default: log(0.5) h1 numeric function returning array length 1. Initial value h1 parameter. Default: 4 = MuSyC_si_to_hi(si=1, Ci=1, E0=1, Ei=0.0) exponent treatment 1 corresponding slope 1 logC2 numeric function returning array length 1. Initial value logC2 parameter. Default: 0 = log(1) logE2 numeric function returning array length 1. Initial value logE2 parameter. Default: log(0.5) h2 numeric function returning array length 1. Initial value h2 parameter. Default: 4 = MuSyC_si_to_hi(si=1, Ci=1, E0=1, Ei=0.0) exponent treatment 1 corresponding slope 1 logE3 numeric function returning array length 1. Initial value logE3 parameter. Default: log(0.5) logalpha numeric function returning array length 1. Initial value logalpha parameter. Default: 0 = log(1) ... additional parameter initialization. named argument function returns numeric array depending dimension parameter, see rstan_default_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","text":"input BayesPharma::model_MuSyC(init = ...) parameter.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Initial Parameter Values for the MuSyC Model — MuSyC_init","text":"","code":"if (FALSE) {   # default prior and init for MuSyC Model   prior <- BayesPharma::MuSyC_prior()   init <- BayesPharma::MuSyC_init()    # Set prior and init for MuSyC model where both treatment 1 and treatment 2   # are assumed to be full inhibitors   BayesPharma::MuSyC_prior(logE0 = 0, E1 = -Inf, E2 = -Inf, E3 = -Inf)   BayesPharma::MuSyC_init(E0 = 1, E1 = -Inf, E2 = -Inf, E3 = -Inf) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a MuSyC Synergy Model — MuSyC_model","title":"Fit a MuSyC Synergy Model — MuSyC_model","text":"MuSyC synergy model bivariate functional form Bliss Loewe synergy models models special cases described (Meyer, et al., 2019) (Wooten, et al., 2021). functional form See MuSyC() full mathematical description MuSyC function. default observed data (therefore columns input data data.frame) <treatment 1>: logd1, log10 dose molar concentration treatment 1 <response>: response, unspecified units <treatment 2>: logd2, log10 dose molar concentration treatment 2 logd1scale logd2scale used center <treatment 1> <treatment 2> make fitting numerically stable. input data, taken mean <treatment 1> <treatment 2> respectively. modeled parameters logE0: log(<response>) <treatment 1> = 0 <treatment 2> = 0 logC1: log(<treatment 1>) <treatment 2> = 0, <response> halfway E0 E1 logE1: log(response) <treatment 1> => Inf <treatment 2> = 0 h1: hill slope response respect <treatment 1> <treatment 1> = C1 <treatment 2> = 0. See MuSyC_hi_to_si() MuSyC_si_to_hi() converting slope (si) hill slope (hi). logC2: log(<treatment 2>) <treatment 1> = 0, <response> halfway E0 E2 logE2: log(response) <treatment 2> => Inf <treatment 1> = 0 h2: hill slope response respect <treatment 2> <treatment 2> = C2 <treatment 1> = 0. See MuSyC_hi_to_si() MuSyC_si_to_hi() converting slopec(si) hill slope (hi). logE3: log(response) <treatment1 1> => Inf <treatment 2> => Inf, modeling synergistic efficacy logalpha: log synergistic potency alpha. alpha > 1 treatments synergistic <treatment 1>`` shifts response due <treatment 2>lower doses visa versa. Whenalpha < 1the treatments antagonistic <treatment 1>shifts response <treatment 2>` higher doses vise versa","code":"<response> ~ MuSyC(       <treatment 1> - <logd1scale>,       <treatment 2> - <logd2scale>,       logE0,       logC1, logE1, h1,       logC2, logE2, h2,       logE3, logalpha)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a MuSyC Synergy Model — MuSyC_model","text":"","code":"MuSyC_model(   data,   prior = MuSyC_prior(),   init = MuSyC_init(),   formula = MuSyC_formula(),   control = list(adapt_delta = 0.99, max_treedepth = 12),   stanvars = c(MuSyC_stanvar(), MuSyC_genquant()),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a MuSyC Synergy Model — MuSyC_model","text":"data data.frame observed data. must contain columns treatment, response additional predictors specified formula. See sigmoid_agonist_formula() details. prior brms::brmsprior() model parameters. create prior MuSyC model, use MuSyC_prior() function. init function giving initial values parameters. specify initial values, use MuSyC_init() function. formula bpformula object. create formula MuSyC model, use MuSyC_formula() function. control named list arguments control sampler's behavior. Adding max_treedepth giving greater value 10 can improve model convergence. stanvars stanvars code MuSyC model. expose_functions logical. Expose sigmoid function used model. needed e.g. brms::loo_compare() ... additional arguments passed brms::brm()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_model.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a MuSyC Synergy Model — MuSyC_model","text":"Meyer, D.J., Wooten, D.J., Paudel B.B., Bauer, J., Hardeman, K.N., Westover, D., Lovly, C.M., Harris, L.., Tyson D.R., Quaranta, V., Quantifying Drug Combination Synergy along Potency Efficacy Axes, Cell Syst. 8, 2 (2019). https://doi.org/10.1016/j.cels.2019.01.003 Wooten, D.J., Meyer, C.T., Lubbock, .L.R. et al. MuSyC consensus framework unifies multi-drug synergy metrics combinatorial drug discovery. Nat Commun 12, 4607 (2021). https://doi.org/10.1038/s41467-021-24789-z","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior for the MuSyC Synergy Model — MuSyC_prior","title":"Create a Prior for the MuSyC Synergy Model — MuSyC_prior","text":"Creating data.frame priors dose response parameters required MuSyC model. like set parameter constant, enter numeric value function argument.  like set distribution, example, function arguments type ec50 = brms::prior(prior = normal(<mu>, <sigma>), nlpar = 'ec50'). distribution options, reference brms::prior Prior Choice Recommendations","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior for the MuSyC Synergy Model — MuSyC_prior","text":"","code":"MuSyC_prior(   logE0 = brms::prior(prior = normal(-0.6931, 3), nlpar = \"logE0\", ub = 0),   logE1 = brms::prior(prior = normal(-1.386, 3), nlpar = \"logE1\", ub = 0),   logC1 = brms::prior(prior = normal(0, 3), nlpar = \"logC1\"),   h1 = brms::prior(prior = normal(4, 3), nlpar = \"h1\", lb = 0.1),   logE2 = brms::prior(prior = normal(-1.386, 3), nlpar = \"logE2\", ub = 0),   logC2 = brms::prior(prior = normal(0, 3), nlpar = \"logC2\"),   h2 = brms::prior(prior = normal(4, 3), nlpar = \"h2\", lb = 0.1),   logE3 = brms::prior(prior = normal(-1.386, 3), nlpar = \"logE3\", ub = 0),   logalpha = brms::prior(prior = normal(0, 0.5), nlpar = \"logalpha\"),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior for the MuSyC Synergy Model — MuSyC_prior","text":"logE0 numeric brms::brmsprior(). Prior log response treatment. (Default: normal(log(0.5), 3) lower bounded 0). logE1 numeric brms::brmsprior(). Prior full log response treatment 1 treatment 2 zero. (Default: normal(log(0.25), 3) lower bounded 0). logC1 numeric brms::brmsprior(). Prior log AC50 treatment 1 dose treatment 2 zero. (Default: normal(log(1), 3)). h1 numeric brms::brmsprior(). Prior slope treatment 1 AC50 treatment 2 zero exponential form. converted slope exponential form, use MuSyC_si_to_hi()). particular, let mu = MuSyC_si_to_hi(si = 1, Ci = 1, E0 = 0, Ei = 0), (Default: normal(mu, 3) lower bounded .1). logE2 numeric brms::brmsprior(). Prior full log response treatment 2 treatment 1 zero. (Default: normal(log(0.25), 3) lower bounded 0). logC2 numeric brms::brmsprior(). Prior log AC50 treatment 2. (Default: normal(log(1), 3)). h2 numeric brms::brmsprior(). Prior slope treatment 2 AC50 treatment 1 zero exponential form. converted slope exponential form, use MuSyC_si_to_hi()). particular, let mu = MuSyC_si_to_hi(si = 1, Ci = 1, E0 = 0, Ei = 0), (Default: normal(mu, 3) lower bounded .1). logE3 numeric brms::brmsprior(). Prior combined full response treatment 1 treatment 2. (Default: normal(log(0.25), 3) lower bounded 0). logalpha numeric brms::brmsprior(). Prior log synergistic potency. values greater 1 synergistic, values less 1 antagonistic. (Default: normal(log(0), 0.5). ... additional brms::brmsprior() objects add prior.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Prior for the MuSyC Synergy Model — MuSyC_prior","text":"brms::brmsprior()  data.frame","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_si_to_hi.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","title":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","text":"can used setting priors interpreting parameter estimates","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_si_to_hi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","text":"","code":"MuSyC_si_to_hi(si, Ci, E0, Ei)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_si_to_hi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","text":"si numeric value slope drug AC50 doses drugs zero Ci numeric value AC50 drug E0 numeric value response treatments Ei numeric value response infinite drug treatments","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_si_to_hi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","text":"hi numeric value exponent MuSyC equation drug ","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_si_to_hi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert From Slope to Exponent Parameterization for Drug i in the MuSyC Model — MuSyC_si_to_hi","text":"Claim: d1=0 d2=C2 gradient response respect d2 s2, symbolically d(Ed)/d(d2) = s2 s2 = h2 * (E0 + E2) / (4 * C2)   Cancel C1^h1 terms:   Distribute derivative across terms numerator   Evaluate d2 = C2:","code":"d(Ed)/d(d2)   = d/d(d2)     (C1^h1 * C2^h2 * E0 + C1^h1 * d2^h2 * E2) /     (C1^h1 * C2^h2      + C1^h1 * d2^h2) =  d/d(d2)      (C2^h2 * E0 + d2^h2 * E2) /      (C2^h2      + d2^h2) =  E0 * C2^h2 * (d/d(d2) 1     / (C2^h2 + d2^h2)) +      E2         * (d/d(d2) d2^h2 / (C2^h2 + d2^h2))    =  E0 * C2^h2 * (h2 * d2^(h2-1) / (C2^h2 + d2^h2)^2) +      E2 * (C2^h2 * h2 * d2^(h2-1) / (C2^h2 + d2^h2)^2)    =  (E0 + E2) * C2^h2 * h2 * d2^(h2-1)/(C2^h2 + d2^h2)^2 =  (E0 + E2) * h2 * C2^(2*h2-1) / (4*C2^(2*h2)))   =  h2 * (E0 + E2) / (4 * C2)"},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the MuSyC Function. — MuSyC_stanvar","title":"Stan Code for the MuSyC Function. — MuSyC_stanvar","text":"Stan Code MuSyC Function.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the MuSyC Function. — MuSyC_stanvar","text":"","code":"MuSyC_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/MuSyC_stanvar.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Stan Code for the MuSyC Function. — MuSyC_stanvar","text":"stanvar script MuSyC equation.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"protein structure prediction key measure accuracy well predicted energy score correlate distance native conformation. common distance measure -atom root mean squared distance (RMSD). challenge, however, expect far away native conformation, energy discriminating, want bias assessment near native conformation. therefore Pnear metric defined (Bhardwaj, et al., Nature, 2016) measures \"funnel-like\" score-vs-rmsd plot . Pnear Rosetta Documentation","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"","code":"Pnear(score, rmsd, lambda = 1.5, kbt = 0.62, verbose = FALSE)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"score vector scores e.g. Rosetta energies e.g. Ref2015. rmsd root mean squared deviation values e.g. backbone atoms lambda Lambda value Angstroms indicating breadth Gaussian used define \"native-like-ness\".  bigger value, permissive calculation structures deviate native. Typical values peptides range 1.5 2.0, proteins 2.0 perhaps 4.0. kbt value k_B*T, energy units, determines large energy gap must order sequence said favor native state. default value, 0.62, correspond physiological temperature ref2015 scorefunction units kcal/mol. verbose give verbose output.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"numeric value.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"","code":"# subtract off the min-score as is done in the Rosetta Code scores = scores - min(scores)  # write down the equation in more code-like notation Pnear <- Sum_i[exp(-RMSD[i]^2/lambda^2)*exp(-scores[i]/k_BT)] /          Sum_i[exp(-scores[i]/k_BT)]  # combine the terms in the first exponential Pnear = Sum_i[exp(-RMSD[i]^2/lambda^2 - scores[i]/k_BT)] /         Sum_i[exp(-scores[i]/k_BT)]  let x_i  = RMSD[i]^2/lambda^2 * k_BT/scores[i]     beta = -scores[i]  Pnear = Sum_i[exp(-RMSD[i]^2/lambda^2*k_BT/scores])]  # Use the log-sum-exponential trick log(Pnear) =   log_sum_exp(-RMSD[i]^2/lambda^2 - scores[i]/k_BT)              - log_sum_exp(-scores[i]/k_BT)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"Unlike Conway discrimination score, PNear calculation uses hard cutoffs.  advantageous repeated testing: scatter points RMSD plot changes slightly run run, PNear value change small amount, whereas metric dependent hard cutoffs change large amount low-energy point crosses RMSD threshold.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"Vikram K. Mulligan (vmulligan\\@flatironinstitute.org) adapted Rosetta","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/Pnear.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the Pnear Quality Metric for a RMSD Funnel — Pnear","text":"","code":"if (FALSE) {  Pnear(score = score_a, rmsd = rmsd_a) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/basic_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Give Basic Statistical Information About the Model Results — basic_stats","title":"Give Basic Statistical Information About the Model Results — basic_stats","text":"Return data.frame containing summary statistics bpfit model. summary statistics included mean, median, standard deviation, lower confidence interval, upper confidence interval.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/basic_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Give Basic Statistical Information About the Model Results — basic_stats","text":"","code":"basic_stats(   model,   predictors_col_name = \"_Intercept\",   half_max_label = \"ec50\",   l_ci = 0.025,   u_ci = 0.975 )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/basic_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Give Basic Statistical Information About the Model Results — basic_stats","text":"model brms::brmsfit() model predictors_col_name character expression predictors column input data.frame. Predictors perturbations tested experiment (.e. Drug, Temperature, etc.) half_max_label character label half maximal fits type experiment done (.e. ec50, ic50, ed50, id50, ld50, etc.). l_ci numeric unit lower confidence interval u_ci numeric unit upper confidence interval","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/basic_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Give Basic Statistical Information About the Model Results — basic_stats","text":"tibble::tibble() object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/basic_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Give Basic Statistical Information About the Model Results — basic_stats","text":"","code":"if (FALSE) {   BayesPharma::basic_stats(     model = my_sigmoid_model,     predictors_col_name = \"predictors\",     half_max_label = \"ic50\",     l_ci = 0.025,     u_ci = 0.975) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/bpfit-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Class bpfit of Models Fit with the BayesPharma Package — bpfit-class","title":"Class bpfit of Models Fit with the BayesPharma Package — bpfit-class","text":"Models fit BayesPharma package model function represented bpfit object, wrapper around brms::brmsfit contains posterior draws (samples), model formula, Stan code, relevant data, information. Additionally, bpfit objects contain bayes_pharma_info list following elements:","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/bpfit-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Class bpfit of Models Fit with the BayesPharma Package — bpfit-class","text":"model_type: character type model elements defined formula, including treatment response variables units BayesPharma information used plots model analysis methods. Additionally, default bpfit objects methods exposed default possible e.g. compare models brms::loo_compare.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/calculate_log_dose.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","title":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","text":"Given dose column data.frame given molar concentration add new column log base-10 dose, log_dose, data.frame return .","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/calculate_log_dose.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","text":"","code":"calculate_log_dose(data, dose_col = \"dose\", molar_concentration = 1)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/calculate_log_dose.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","text":"data data.frame containing column representing dose molar units. dose_col expression dose column input data.frame (Default: \"dose\") molar_concentration numeric units molar concentration dose column (Default: 1).","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/calculate_log_dose.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","text":"input data.frame appended log_dose column log10(<dose_col>) * molar_concentration.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/calculate_log_dose.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a Log(dose) (in base 10) Column to the Input data.frame — calculate_log_dose","text":"","code":"if (FALSE) { # Consider observations at doses of 1 μM and 0.1 μM. # If the doses are given in molar units (M) then data <- data.frame(dose = c(1e-6, 1e-7)) |>    BayesPharma::calculate_log_dose(dose_col = dose, molar_concentration = 1) data$log_dose == c(-6, -7)  # If the doses are given with in units of nanomolar (nM) then data <- data.frame(dose_nM = c(1000, 100)) |>   BayesPharma::calculate_log_dose(     dose_col = dose_nM,     molar_concentration = 1e-9) data$log_dose == c(-6, -7) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_init_output_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to initialize output for the BayesPharma CLI — cli_init_output_path","title":"Helper function to initialize output for the BayesPharma CLI — cli_init_output_path","text":"check output directory exists create ","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_init_output_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to initialize output for the BayesPharma CLI — cli_init_output_path","text":"","code":"cli_init_output_path(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_init_output_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to initialize output for the BayesPharma CLI — cli_init_output_path","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_bivariate_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load sigmoid formula the BayesPharma CLI — cli_load_bivariate_formula","title":"Helper function to load sigmoid formula the BayesPharma CLI — cli_load_bivariate_formula","text":"Initialize bivaraite formula based command line arguments. models support multiple formulas, otherwise use default one model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_bivariate_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load sigmoid formula the BayesPharma CLI — cli_load_bivariate_formula","text":"","code":"cli_load_bivariate_formula(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_bivariate_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load sigmoid formula the BayesPharma CLI — cli_load_bivariate_formula","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_bivariate_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load sigmoid formula the BayesPharma CLI — cli_load_bivariate_formula","text":"BayesPharma::bpformula","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load data for the BayesPharma CLI — cli_load_data","title":"Helper function to load data for the BayesPharma CLI — cli_load_data","text":"load tabular data based extension used fit model Recognized data formats .csv, .tsv, .xlsx","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load data for the BayesPharma CLI — cli_load_data","text":"","code":"cli_load_data(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load data for the BayesPharma CLI — cli_load_data","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load data for the BayesPharma CLI — cli_load_data","text":"data.frame","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load init the BayesPharma CLI — cli_load_init","title":"Helper function to load init the BayesPharma CLI — cli_load_init","text":"Initialize init based command line arguments.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load init the BayesPharma CLI — cli_load_init","text":"","code":"cli_load_init(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load init the BayesPharma CLI — cli_load_init","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load init the BayesPharma CLI — cli_load_init","text":"function","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_model_fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load model function the BayesPharma CLI — cli_load_model_fn","title":"Helper function to load model function the BayesPharma CLI — cli_load_model_fn","text":"Initialize model function based command line arguments Available models defined BayesPharma::<model>_model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_model_fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load model function the BayesPharma CLI — cli_load_model_fn","text":"","code":"cli_load_model_fn(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_model_fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load model function the BayesPharma CLI — cli_load_model_fn","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_model_fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load model function the BayesPharma CLI — cli_load_model_fn","text":"function used fit requested model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load prior the BayesPharma CLI — cli_load_prior","title":"Helper function to load prior the BayesPharma CLI — cli_load_prior","text":"Initialize prior based command line arguments.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load prior the BayesPharma CLI — cli_load_prior","text":"","code":"cli_load_prior(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load prior the BayesPharma CLI — cli_load_prior","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load prior the BayesPharma CLI — cli_load_prior","text":"brms::brmsprior","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_univariate_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to load a univariate formula for the BayesPharma CLI — cli_load_univariate_formula","title":"Helper function to load a univariate formula for the BayesPharma CLI — cli_load_univariate_formula","text":"Initialize univariate formula based command line arguments. models support multiple formulas, otherwise use default one model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_univariate_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to load a univariate formula for the BayesPharma CLI — cli_load_univariate_formula","text":"","code":"cli_load_univariate_formula(options)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_univariate_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to load a univariate formula for the BayesPharma CLI — cli_load_univariate_formula","text":"options list command line arguments parsed cli_parse_options().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_load_univariate_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to load a univariate formula for the BayesPharma CLI — cli_load_univariate_formula","text":"BayesPharma::bpformula","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_parse_options.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to parse command line arguments for the BayesPharma CLI — cli_parse_options","title":"Helper function to parse command line arguments for the BayesPharma CLI — cli_parse_options","text":"Pass command line arguments list use optparse package parse . Available arguments -v, --verbose Print extra output --data=DATA path either .csv, .tsv, .xls .xlsx data file --data_sheet=DATA_SHEET data file excel file, sheet use? --data_range=DATA_RANGE data file excel file, range use? --model=MODEL model fit --formula=FORMULA type formula use? models canonical formula, try guess . --treatment_variable=TREATMENT_VARIABLE variable use treatment. specified use default given formula. --treatment_units=TREATMENT_UNITS units units used treatment variable. specified use default given formula. --response_variable=RESPONSE_VARIABLE variable use response. specified use default given formula. --response_units=RESPONSE_UNITS units units used response variable. specified use default given formula. --predictors=PREDICTORS Expression predictors model parameters. --prior_terms=PRIOR_TERMS json formatted list arguments prior function. example, constrain EC50 mean 1 nM bottom 0 sigmoid_agonist use --prior_terms='[{\"ec50\":\"brms::prior(prior = normal(-9, 0.5), nlpar = \"ec50\")},{\"bottom\":\"0\"}]' --init_terms=INIT_TERMS json formmated list arguments init function. --iter=ITER Number sampling iterations. --output_path=OUTPUT_PATH Path output results written","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_parse_options.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to parse command line arguments for the BayesPharma CLI — cli_parse_options","text":"","code":"cli_parse_options(args)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_parse_options.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to parse command line arguments for the BayesPharma CLI — cli_parse_options","text":"args list command line arguments","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/cli_parse_options.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to parse command line arguments for the BayesPharma CLI — cli_parse_options","text":"named list values available arguments","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/constant_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Formula for a Curve with a Constant Response — constant_formula","title":"Formula for a Curve with a Constant Response — constant_formula","text":"Set-equation formula objects constant response.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/constant_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formula for a Curve with a Constant Response — constant_formula","text":"","code":"constant_formula(   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/constant_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Formula for a Curve with a Constant Response — constant_formula","text":"response_variable character variable representing response treatment response_units character units response predictors Additional formula objects specify predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? (Default: 1) random effect taken consideration? .e. cell number, plate number, etc. ... additional arguments brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/constant_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Formula for a Curve with a Constant Response — constant_formula","text":"bpformula brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/constant_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Formula for a Curve with a Constant Response — constant_formula","text":"","code":"if (FALSE) {   constant_formula(predictors = 0 + predictors) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/drc_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for DRC Dose Response Models — drc_model","title":"Wrapper for DRC Dose Response Models — drc_model","text":"Dose Response Curve (drc) package supports regression models sigmoidal functional forms. wrapper sets similar model sigmiod_model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/drc_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for DRC Dose Response Models — drc_model","text":"","code":"drc_model(   data,   formula = response ~ log_dose,   fct = drc::L.4(fixed = c(NA, NA, NA, NA), names = c(\"hill\", \"bottom\", \"top\", \"ec50\")),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/drc_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for DRC Dose Response Models — drc_model","text":"data data.frame formula formula formula relating response log_dose, drc::L.4 sigmoid link function used dose drc::LL.4 log-linear sigmoid link functions used fct argument. fct Boltzmann non-linear link function. Default 4 parameter log-linear sigmoid equation, drc::L.4, parameters estimated. fix subset , set parameters constant values. ... additional arguments passed drc::drm","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/drc_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for DRC Dose Response Models — drc_model","text":"object (S3) class drc drc package.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/drc_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper for DRC Dose Response Models — drc_model","text":"","code":"if (FALSE) { BayesPharma::drc_model(   data = tibble::tibble(     log_dose = seq(-7, -5, length.out = 20),     mean_response = BayesPharma::sigmoid(       ac50 = -6, hill = -1, top = 1, bottom = 0, log_dose = log_dose),     response = stats::rnorm(n = 20, mean = 0, sd = 0.2))) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate an init — eval_init","title":"Evaluate an init — eval_init","text":"brms models can initialized depends backend. method backends supports list (one chain) lists (one variable) numeric values. Since requires knowing many chains run, may available model defined, support random initialization, rstan backend also supports initialization function returning list functions (one parameter) returning numeric array length 1. Also, support common use-case initializing everything zero randomly range (-2, 2) unconstrained scale, rstan also supports initializing 0 \"random\". make BayesPharma backend agnostic, helper function takes init number chains reduces list list format.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate an init — eval_init","text":"","code":"eval_init(init, sdata = NULL, chains = 4)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate an init — eval_init","text":"init One NULL, numeric, character case use default rstan init named list one element parameter. values can either array, numeric, function returning numeric value sdata result running brms::make_standata(), particular list elements K_<parameter_name> parameter model. value elements dimension parameter. chains numeric number chains initialize","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate an init — eval_init","text":"list lists form model initialization.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init_one_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for eval_init_one_param — eval_init_one_param","title":"Helper function for eval_init_one_param — eval_init_one_param","text":"Helper function eval_init_one_param","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init_one_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for eval_init_one_param — eval_init_one_param","text":"","code":"eval_init_one_param(param_init, param_name, sdata)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init_one_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function for eval_init_one_param — eval_init_one_param","text":"param_init array, numeric, function initialize parameter param_name character parameter name defined stan model sdata list generated Stan model data info","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/eval_init_one_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function for eval_init_one_param — eval_init_one_param","text":"numeric array. parameter form b_<param> brms expects array dimension sdata$K_<param>, otherwise return numeric value.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/expect_gg.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if an Object is a ggplot2 Plot — expect_gg","title":"Check if an Object is a ggplot2 Plot — expect_gg","text":"Use tests check object ggplot2::ggplot object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/expect_gg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if an Object is a ggplot2 Plot — expect_gg","text":"","code":"expect_gg(x)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/expect_gg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if an Object is a ggplot2 Plot — expect_gg","text":"x ggplot2::ggplot object","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/expect_gg.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Check if an Object is a ggplot2 Plot — expect_gg","text":"borrowed bayesplot:::expect_gg","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/fit_model_cli.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit model using command line arguments — fit_model_cli","title":"Fit model using command line arguments — fit_model_cli","text":"Provide command line interface fitting BayesPharma models","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/fit_model_cli.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit model using command line arguments — fit_model_cli","text":"","code":"fit_model_cli(args = commandArgs(trailingOnly = TRUE))"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/fit_model_cli.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit model using command line arguments — fit_model_cli","text":"args list command line arguments","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_units.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the Response Variable Units from a BayesPharma Model — get_response_units","title":"Get the Response Variable Units from a BayesPharma Model — get_response_units","text":"Get Response Variable Units BayesPharma Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_units.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the Response Variable Units from a BayesPharma Model — get_response_units","text":"","code":"get_response_units(model)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_units.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the Response Variable Units from a BayesPharma Model — get_response_units","text":"model bpfit object resulting fitting model one model functions BayesPharma package.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_units.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the Response Variable Units from a BayesPharma Model — get_response_units","text":"character response variable units","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_variable.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the Response Variable from a BayesPharma Model — get_response_variable","title":"Get the Response Variable from a BayesPharma Model — get_response_variable","text":"Get Response Variable BayesPharma Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_variable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the Response Variable from a BayesPharma Model — get_response_variable","text":"","code":"get_response_variable(model)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_variable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the Response Variable from a BayesPharma Model — get_response_variable","text":"model bpfit object resulting fitting model one model functions BayesPharma package.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_response_variable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the Response Variable from a BayesPharma Model — get_response_variable","text":"character response variable","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_units.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the Treatment Variable Units from a BayesPharma Model — get_treatment_units","title":"Get the Treatment Variable Units from a BayesPharma Model — get_treatment_units","text":"Get Treatment Variable Units BayesPharma Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_units.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the Treatment Variable Units from a BayesPharma Model — get_treatment_units","text":"","code":"get_treatment_units(model)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_units.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the Treatment Variable Units from a BayesPharma Model — get_treatment_units","text":"model bpfit object resulting fitting model one model functions BayesPharma package.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_units.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the Treatment Variable Units from a BayesPharma Model — get_treatment_units","text":"character treatment variable units","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_variable.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the Treatment Variable from a BayesPharma Model — get_treatment_variable","title":"Get the Treatment Variable from a BayesPharma Model — get_treatment_variable","text":"Get Treatment Variable BayesPharma Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_variable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the Treatment Variable from a BayesPharma Model — get_treatment_variable","text":"","code":"get_treatment_variable(model)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_variable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the Treatment Variable from a BayesPharma Model — get_treatment_variable","text":"model bpfit object resulting fitting model one model functions BayesPharma package.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/get_treatment_variable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the Treatment Variable from a BayesPharma Model — get_treatment_variable","text":"character treatment variable","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":null,"dir":"Reference","previous_headings":"","what":"Richards growth function — growth_richards","title":"Richards growth function — growth_richards","text":"Functional form Richards growth model.   parameterization follows (Zwietering, 1990) grofit:","code":"response(time) =   K0 + (K - K0)/(     1 + nu * exp(       1 + nu + rate/(K - K0) * (1 + nu)^(1 + 1/nu) *       (lambda - time))) ^ (1/nu) K      = **carrying capacity**, `K = response(time = Inf)`. The          \\pkg{grofit} package calls this parameter `A`. `K` has the same          units as the `response`. K0     = **initial population size** `K0 = response(time = 0)`. The          \\pkg{grofit} package assumes `K0=0`. `K0` has the same units as          the `response`. rate   = **maximum growth rate** `rate = max[d(response)/d(time)]`. The          \\pkg{grofit} package calls this `mu`. `rate` has the units of          `response/time` lambda = **duration of the lag-phase** the time point at which the          tangent through the growth curve when it achieves the maximum          growth rate crosses the initial population size `K0`. (see          Figure 2 in (Kahm et al., 2010)). nu     = **growth asymmetry** before and after the inflection"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Richards growth function — growth_richards","text":"","code":"growth_richards(K, K0, rate, lambda, nu, time)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Richards growth function — growth_richards","text":"K numeric carrying capacity K0 numeric baseline response rate numeric maximum growth rate lambda numeric duration lag-phase nu numeric growth asymmetry inflection point time numeric time point evaluate response","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Richards growth function — growth_richards","text":"numeric response given time parameters","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Richards growth function — growth_richards","text":"Zwietering M. H., Jongenburger ., Rombouts F. M., van 't Riet K., (1990) Modeling Bacterial Growth Curve. Appl. Environ. Microbiol., 56(6), 1875-1881 https://doi.org/10.1128/aem.56.6.1875-1881.1990 Kahm, M., Hasenbrink, G., Lichtenberg-Fraté, H., Ludwig, J., & Kschischo, M. (2010). grofit: Fitting Biological Growth Curves R. J. Stat. Softw., 33(7), 1–21. https://doi.org/10.18637/jss.v033.i07","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Richards growth function — growth_richards","text":"","code":"if (FALSE) {  # Generate Richards growth curve  data <- data.frame(    time = seq(0, 2, length.out = 101)) |>      dplyr::mutate(        response = stats::rnorm(          n = length(time),          mean = BayesPharma::growth_richards(            K = 1,            K0 = 0,            rate = 2,            lambda = 0.5,            nu = 2,            time = time),        sd = .2)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Formula for the Richards Growth Model — growth_richards_formula","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"set-Richards growth model formula use growth_richards_model BayesPharma package. functional form   parameterization follows (Zwietering, 1990) grofit:   See vignettes(topic = \"derive_growth_model\", package = \"BayesPharma\") details.","code":"response ~ richards_growth(K, K0, rate, lambda, nu, time) K      = **carrying capacity**, `K = response(time = Inf)`. The          \\pkg{grofit} package calls this parameter `A`. `K` has the same          units as the `response`. K0     = **initial population size** `K0 = response(time = 0)`. The          \\pkg{grofit} package assumes `K0=0`. `K0` has the same units as          the `response`. rate   = **maximum growth rate** `rate = max[d(response)/d(time)]`. The          \\pkg{grofit} package calls this `mu`. `rate` has the units of          `response/time` lambda = **duration of the lag-phase** the time point at which the          tangent through the growth curve when it achieves the maximum          growth rate crosses the initial population size `K0`. (see          Figure 2 in (Kahm et al., 2010)). nu     = **growth asymmetry** before and after the inflection          point."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"","code":"growth_richards_formula(   treatment_variable = \"time\",   treatment_units = \"hours\",   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"treatment_variable character variable representing time treatment treatment_units character units time variable response_variable character variable representing response treatment response_units character units response predictors Additional formula objects specify predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? (Default: 1) random effect taken consideration? .e. cell number, plate number, etc. ... additional arguments brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"bpformula, subclass brms::brmsformula() can passed growth_richards_model().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"Zwietering M. H., Jongenburger ., Rombouts F. M., van 't Riet K., (1990) Modeling Bacterial Growth Curve. Appl. Environ. Microbiol., 56(6), 1875-1881 https://doi.org/10.1128/aem.56.6.1875-1881.1990 Kahm, M., Hasenbrink, G., Lichtenberg-Fraté, H., Ludwig, J., & Kschischo, M. (2010). grofit: Fitting Biological Growth Curves R. J. Stat. Softw., 33(7), 1–21. https://doi.org/10.18637/jss.v033.i07","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Formula for the Richards Growth Model — growth_richards_formula","text":"","code":"if (FALSE) {   # Data has a string column drug_id with drug identifiers   # Fit a separate model for each drug   BayesPharma::growth_richards_formula(predictors = 0 + drug_id)    # Data has a string column plate_id with plate identifiers   # Estimate the change in response for each plate relative to a global   # baseline.   BayesPharma::growth_richards_formula(predictors = plate_id)    # data has columns drug_id and plate_id   # fit a multilevel model where the drug effect depends on the plate   BayesPharma::growth_richards_formula(predictors = 0 + (drug_id|plate_id)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Initialization for the Richards Growth Model — growth_richards_init","title":"Create Initialization for the Richards Growth Model — growth_richards_init","text":"Create initial values Richards growth model parameters can passed growth_richards_model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Initialization for the Richards Growth Model — growth_richards_init","text":"","code":"growth_richards_init(   K = function() runif(n = 1, min = 0.8, max = 1.2),   K0 = function() runif(n = 1, min = -0.2, max = 0.2),   rate = function() runif(n = 1, min = 0.8, max = 1.2),   lambda = function() runif(n = 1, min = 0.3, max = 0.7),   nu = function() runif(n = 1, min = 0.8, max = 1.2),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Initialization for the Richards Growth Model — growth_richards_init","text":"K numeric numeric returning function K0 numeric numeric returning function rate numeric numeric returning function lambda numeric numeric returning function nu numeric numeric returning function values range [0, Inf], 1 standard sigmoid ... additional parameter initialization. named argument function returns numeric array length 1, see rstan_default_scalar_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Initialization for the Richards Growth Model — growth_richards_init","text":"input [brm][brms::brm](init = ...)","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Initialization for the Richards Growth Model — growth_richards_init","text":"","code":"if (FALSE) { init <- BayesPharma::growth_richards_init(   A = 100,   nu = 2) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Bayesian Richards Growth Model — growth_richards_model","title":"Run Bayesian Richards Growth Model — growth_richards_model","text":"additional information additional function arguments, reference: brm stan documentation.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Bayesian Richards Growth Model — growth_richards_model","text":"","code":"growth_richards_model(   data,   formula = growth_richards_formula(),   prior = growth_richards_prior(),   init = growth_richards_init(),   iter = 8000,   control = list(adapt_delta = 0.99),   stanvar_function = growth_richards_stanvar(),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Bayesian Richards Growth Model — growth_richards_model","text":"data data.frame experimental data. Must contain column representing treatment, response predictors specified formula. formula bpformula object. create growth model formula, use growth_richards_formula() prior brmspriors data.frame K, K0, rate, lambda, nu. create prior, use growth_richards_prior() init initial values parameters modeled. create init, use growth_richards_init() iter numeric value number iterations model runs. Increasing iter can help model convergence control named list parameters control sampler's behavior. Adding max_treedepth giving greater value 10 can improve model convergence stanvar_function Stan code model expose_functions logical. Expose stan functions model. needed e.g. run brms::loo_compare() ... additional arguments passed brms::brm()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Bayesian Richards Growth Model — growth_richards_model","text":"bpfit wraps brms::brmsfit()","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Bayesian Richards Growth Model — growth_richards_model","text":"","code":"if (FALSE) {   BayesPharma::growth_sigmoid_model(     data = data,     formula = BayesPharma::growth_richards_formula(predictors = 0 + drug)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior for the Richards Growth Model — growth_richards_prior","title":"Create a Prior for the Richards Growth Model — growth_richards_prior","text":"Create priors Richards growth model. function arguments K, K0, rate, lambda, nu NULL, normal distribution priors set. like set parameter constant, enter numeric value function argument. distribution options, reference brms::prior Prior Choice Recommendations","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior for the Richards Growth Model — growth_richards_prior","text":"","code":"growth_richards_prior(   K = brms::prior(prior = normal(1, 0.5), nlpar = \"K\"),   K0 = brms::prior(prior = normal(0, 0.5), nlpar = \"K0\"),   rate = brms::prior(prior = normal(2, 0.5), nlpar = \"rate\", lb = 0),   lambda = brms::prior(prior = normal(0.5, 0.5), nlpar = \"lambda\"),   nu = brms::prior(prior = normal(1, 1), nlpar = \"nu\", lb = 0),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior for the Richards Growth Model — growth_richards_prior","text":"K brms::brmsprior() numeric. Prior K parameter. (Default: normal(1, 0.5)). K0 brms::brmsprior() numeric. Prior K0 parameter. (Default: normal(0, 0.5)). rate brms::brmsprior() numeric. Prior rate parameter. (Default: normal(1, 1) lower bound 0). lambda brms::brmsprior() numeric. Prior lambda parameter. (Default: normal(0.5, 0.5)). nu brms::brmsprior() numeric. Prior nu parameter.  (Default: normal(1, 1) lower bound 0). ... additional brms::brmsprior() objects.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Prior for the Richards Growth Model — growth_richards_prior","text":"brms::brmsprior()  data.frame","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Prior for the Richards Growth Model — growth_richards_prior","text":"","code":"if (FALSE) { priors <- growth_richards_prior(   K = brms::prior(prior = normal(100, 20), nlpar = \"K\"),   nu = brms::prior(prior = normal(2, 4), nlpar = \"nu\"),   lambda = 1) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the Richards Growth Function. — growth_richards_stanvar","title":"Stan Code for the Richards Growth Function. — growth_richards_stanvar","text":"Stan Code Richards Growth Function.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the Richards Growth Function. — growth_richards_stanvar","text":"","code":"growth_richards_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_stanvar.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Stan Code for the Richards Growth Function. — growth_richards_stanvar","text":"stanvar script Richard growth model response equation.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_richards_stanvar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stan Code for the Richards Growth Function. — growth_richards_stanvar","text":"","code":"if (FALSE) { brms::brm(   data = data.frame(     response = ...,     time = ...),   formula = brms::brmsformula(     response ~ growth_richards(K, K0, rate, lambda, nu, time),     K + K0 + rate + lambda + nu ~ 1,     nl = TRUE),   prior = ...,   init =  ...,   stanvars = BayesPharma::growth_sigmoid_stanvar()) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Sigmoid growth function — growth_sigmoid","title":"Sigmoid growth function — growth_sigmoid","text":"Functional form sigmoid growth model, related Richards growth model setting nu = 1. parameterization follows (Zwietering, 1990) grofit:   See vignettes(topic = \"derive_growth_model\", package = \"BayesPharma\") details.","code":"K      = **carrying capacity**, `K = response(time = Inf)`. The          \\pkg{grofit} package calls this parameter `A`. `K` has the same          units as the `response`. K0     = **initial population size** `K0 = response(time = 0)`. The          \\pkg{grofit} package assumes `K0=0`. `K0` has the same units as          the `response`. rate   = **maximum growth rate** `rate = max[d(response)/d(time)]`. The          \\pkg{grofit} package calls this `mu`. `rate` has the units of          `response/time` lambda = **duration of the lag-phase** the time point at which the          tangent through the growth curve when it achieves the maximum          growth rate crosses the initial population size `K0`. (see          Figure 2 in (Kahm et al., 2010))."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sigmoid growth function — growth_sigmoid","text":"","code":"growth_sigmoid(K, K0, rate, lambda, time)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sigmoid growth function — growth_sigmoid","text":"K numeric, carrying capacity K0 numeric, initial population size rate numeric, maximum growth rate lambda numeric, duration lag-phase time numeric, time point evaluate response","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sigmoid growth function — growth_sigmoid","text":"numeric, response given time parameters","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sigmoid growth function — growth_sigmoid","text":"Richards growth model given response(time) = K0 + (K - K0)/(1 + nu * exp( 1 + nu + rate/(K - K0) * (1 + nu)^(1 + 1/nu) * (lambda - time))) ^ (1/nu) Setting nu = 1, simplifying gives response(time) = K0 + (K - K0)/(1 + 1 * exp( 1 + 1 + rate/(K - K0) * (1 + 1)^(1 + 1/1) * (lambda - time))) ^ (1/1) response(time) = K0 + (K - K0)/(1 + exp( 2 + rate/(K - K0) * (2)^(2) * (lambda - time))) ^ (1/1) response(time) = K0 + (K - K0)/(1 + exp(2 + rate/(K - K0) * 4 * (lambda - time))) response(time) = K0 + (K - K0)/(1 + exp(4 * rate/(K - K0) * (lambda - time) + 2)) sigmoid growth curve related sigmoid agoinst model setting top = K, bottom = K0, hill = 4 * rate / (K - K0) / log10(e), AC50 = lambda + 2 * log10(e) / hill, log_dose = time, e exp(1): response(time) = bottom + (top - bottom)/(1 + exp(hill/log10(e) * (lambda - time) + 2)) response(time) = bottom + (top - bottom)/(1 + exp(hill/log10(e) * (AC50 - time))) response(log_dose) = bottom + (top - bottom)/(1 + 10^((ac50 - log_dose) * hill))","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sigmoid growth function — growth_sigmoid","text":"Zwietering M. H., Jongenburger ., Rombouts F. M., van 't Riet K., (1990) Modeling Bacterial Growth Curve. Appl. Environ. Microbiol., 56(6), 1875-1881 https://doi.org/10.1128/aem.56.6.1875-1881.1990 Kahm, M., Hasenbrink, G., Lichtenberg-Fraté, H., Ludwig, J., & Kschischo, M. (2010). grofit: Fitting Biological Growth Curves R. J. Stat. Softw., 33(7), 1–21. https://doi.org/10.18637/jss.v033.i07","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sigmoid growth function — growth_sigmoid","text":"","code":"if (FALSE) {  # Generate Sigmoid growth curve  data <- data.frame(    time = seq(0, 2, length.out = 101)) |>      dplyr::mutate(        response = stats::rnorm(          n = length(time),          mean = BayesPharma::growth_sigmoid(            K = 1,            K0 = 0,            rate = 2,            lambda = 0.5,            time = time),        sd = .2)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"Set-sigmoid growth model formula use growth_sigmoid_model(). functional form   parameterization follows (Zwietering, 1990) grofit:   See vignettes(topic = \"derive_growth_model\", package = \"BayesPharma\") details.","code":"response ~ growth_sigmoid(K, K0, rate, lambda, time) K      = **carrying capacity**, `K = response(time = Inf)`. The          \\pkg{grofit} package calls this parameter `A`. `K` has the same          units as the `response`. K0     = **initial population size** `K0 = response(time = 0)`. The          \\pkg{grofit} package assumes `K0=0`. `K0` has the same units as          the `response`. rate   = **maximum growth rate** `rate = max[d(response)/d(time)]`. The          \\pkg{grofit} package calls this `mu`. `rate` has the units of          `response/time` lambda = **duration of the lag-phase** the time point at which the          tangent through the growth curve when it achieves the maximum          growth rate crosses the initial population size `K0`. (see          Figure 2 in (Kahm et al., 2010))."},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"","code":"growth_sigmoid_formula(   treatment_variable = \"time\",   treatment_units = \"hours\",   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"treatment_variable character variable representing time treatment treatment_units character units time variable response_variable character variable representing response treatment response_units character units response predictors Additional formula objects specify predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? (Default: 1) random effect taken consideration? .e. cell number, plate number, etc. ... additional arguments brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"bpformula, subclass brms::brmsformula can passed growth_sigmoid_model().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"Zwietering M. H., Jongenburger ., Rombouts F. M., van 't Riet K., (1990) Modeling Bacterial Growth Curve. Appl. Environ. Microbiol., 56(6), 1875-1881 https://doi.org/10.1128/aem.56.6.1875-1881.1990 Kahm, M., Hasenbrink, G., Lichtenberg-Fraté, H., Ludwig, J., & Kschischo, M. (2010). grofit: Fitting Biological Growth Curves R. J. Stat. Softw., 33(7), 1–21. https://doi.org/10.18637/jss.v033.i07","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Formula for the Sigmoid Growth Model — growth_sigmoid_formula","text":"","code":"if (FALSE) {   # Data has a string column drug_id with drug identifiers   # Fit a separate model for each drug   BayesPharma::growth_sigmoid_formula(predictors = 0 + drug_id)    # Data has a string column plate_id with plate identifiers   # Estimate the change in response for each plate relative to a global   # baseline.   BayesPharma::growth_sigmoid_formula(predictors = plate_id)    # data has columns drug_id and plate_id   # fit a multilevel model where the drug effect depends on the plate   BayesPharma::growth_sigmoid_formula(predictors = 0 + (drug_id|plate_id)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","title":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","text":"Create initial values sigmoid growth model parameters can passed growth_sigmoid_model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","text":"","code":"growth_sigmoid_init(   K = function() runif(n = 1, min = 0.8, max = 1.2),   K0 = function() runif(n = 1, min = -0.2, max = 0.2),   rate = function() runif(n = 1, min = 0.8, max = 1.2),   lambda = function() runif(n = 1, min = 0.3, max = 0.7),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","text":"K numeric numeric returning function K0 numeric numeric returning function rate numeric numeric returning function lambda numeric numeric returning function units time ... additional parameter initialization. named argument function returns numeric array depending dimension parameter, see rstan_default_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","text":"input [brm][brms::brm](init = ...)","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Initialization for the Sigmoid Growth Model — growth_sigmoid_init","text":"","code":"if (FALSE) { init <- BayesPharma::growth_sigmoid_init(   A = 100) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","title":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","text":"additional information additional function arguments, reference: brms::brms() stan documentation.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","text":"","code":"growth_sigmoid_model(   data,   formula = growth_richards_formula(),   prior = growth_richards_prior(),   init = growth_richards_init(),   iter = 8000,   control = list(adapt_delta = 0.99),   stanvar_function = growth_sigmoid_stanvar(),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","text":"data data.frame experimental data. Must contain column representing treatment, response predictors specified formula. formula bpformula object. create growth model formula, use growth_sigmoid_formula() prior brmspriors data.frame K, K0, rate, lambda. create prior, use growth_sigmoid_prior(). init initial values parameters modeled. create init, use growth_sigmoid_init() iter numeric value number iterations model runs. Increasing iter can help model convergence control named list parameters control sampler's behavior. Adding max_treedepth giving greater value 10 can improve model convergence stanvar_function Stan code model expose_functions logical. Expose stan functions model. needed e.g. run brms::loo_compare() ... additional arguments passed brms::brm()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","text":"bpfit wrapper brms::brmsfit()","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run the Bayesian Sigmoid Growth Model — growth_sigmoid_model","text":"","code":"if (FALSE) {   BayesPharma::growth_sigmoid_model(     data = data,     formula = BayesPharma::growth_richards_formula(predictors = 0 + drug)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","title":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","text":"Create prior sigmoid growth model. function arguments K, K0, rate, lambda, NULL, normal distribution priors set. like set parameter constant, enter numeric  value function argument. distribution options, reference brms::prior Prior Choice Recommendations","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","text":"","code":"growth_sigmoid_prior(   K = brms::prior(prior = normal(1, 0.5), nlpar = \"K\"),   K0 = brms::prior(prior = normal(0, 0.5), nlpar = \"K0\"),   rate = brms::prior(prior = normal(2, 0.5), nlpar = \"rate\", lb = 0),   lambda = brms::prior(prior = normal(0.5, 0.5), nlpar = \"lambda\"),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","text":"K brms::brmsprior() numeric. Prior K parameter. (Default: normal(1, 0.5)) K0 brms::brmsprior() numeric. Prior K0 parameter. (Default: normal(0, 0.5)) rate brms::brmsprior() numeric. Prior rate parameter. (Default: normal(1, 1) lower bound 0). lambda brms::brmsprior() numeric. Prior lambda parameter. (Default: normal(0.5, 0.5)). ... additional brms::brmsprior() objects.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","text":"brms::brmsprior()  data.frame","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Prior for the Sigmoid Growth Model — growth_sigmoid_prior","text":"","code":"if (FALSE) { priors <- growth_sigmoid_prior(   K = brms::prior(prior = normal(100, 20), nlpar = \"K\"),   lambda = 1) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the Growth Richards Function. — growth_sigmoid_stanvar","title":"Stan Code for the Growth Richards Function. — growth_sigmoid_stanvar","text":"Stan Code Growth Richards Function.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the Growth Richards Function. — growth_sigmoid_stanvar","text":"","code":"growth_sigmoid_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_stanvar.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Stan Code for the Growth Richards Function. — growth_sigmoid_stanvar","text":"stanvar script sigmoid growth model response equation","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/growth_sigmoid_stanvar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stan Code for the Growth Richards Function. — growth_sigmoid_stanvar","text":"","code":"if (FALSE) { brms::brm(   data = data.frame(     response = ...,     time = ...),   formula = brms::brmsformula(     response ~ growth_sigmoid(K, K0, rate, lambda, time),     K + K0 + rate + lambda ~ 1,     nl = TRUE),   prior = ...,   init =  ...,   stanvars = BayesPharma::growth_sigmoid_stanvar()) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/kor_antag.html","id":null,"dir":"Reference","previous_headings":"","what":"Dose Response Measurements of Four Different Kappa Opioid Receptor\nAntagonists — kor_antag","title":"Dose Response Measurements of Four Different Kappa Opioid Receptor\nAntagonists — kor_antag","text":"data set containing drugs used, cell id, log dose response measured , reference, raw, normalized measurement","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/kor_antag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dose Response Measurements of Four Different Kappa Opioid Receptor\nAntagonists — kor_antag","text":"","code":"kor_antag"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/kor_antag.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dose Response Measurements of Four Different Kappa Opioid Receptor\nAntagonists — kor_antag","text":"data.frame includes dose-response measurements","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/kor_antag.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dose Response Measurements of Four Different Kappa Opioid Receptor\nAntagonists — kor_antag","text":"https://github.com/maomlab/BayesPharma","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","title":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","text":"Generate data Michaelis Menten enzyme kinetics ordinary differential equation described (Choi, et al., 2017, DOI: 10.1038/s41598-017-17072-z). Consider kinetic rate equation free enzyme (E) reversibly binds substrate (S) form complex (C) forward backward rate constants kf kb, irreversibly catalyzed product (P), rate constant kcat, releasing enzyme catalyze additional substrate. total enzyme concentration defined ET := E + C. total substrate product concentration defined ST := S + C + P. Michaelis constant defined kM := (kb + kcat) / kf. kcat rate constant determines maximum turn saturating substrate concentrations, Vmax := kcat * ET. rate constants kcat kM can estimated monitoring product accumulation time (enzyme progress curves), varying enzyme substrate concentrations. (Choi, et al, 2017, equation 2, Michaelis Menten differential equation defined (Choi, et al. 2017) prove, tQ model valid K = kb/kf dissociation constant.","code":"kf                  --->    kcat           E + S  <---  C --->  E + P                   kb Observed data:      M     = number of measurements        # number of measurements      t[M]  = time                          # measured in seconds      Pt[M] = product                       # product produced at time t      ST    = substrate total concentration # specified for each experiment      ET    = enzyme total concentration    # specified for each experiment    Model parameters:     kcat    # catalytic constant (min^-1)     kM      # Michaelis constant ()    ODE formulation:     dPdt = kcat * (              ET + kM + ST - Pt +              -sqrt((ET + kM + ST - Pt)^2 - 2 * ET * (ST - Pt))) / 2    initial condition:      P := 0 K/(2*ST) * (ET+kM+ST) / sqrt((ET+kM+ST+P)^2 - 4*ET(ST-P)) << 1,"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","text":"","code":"michaelis_menten(time, kcat, kM, ET, ST, ...)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","text":"time numeric vector. Increasing time points kcat numeric value catalytic rate constant kM numeric value Michaelis rate constant ET numeric value total enzyme concentration ST numeric value total substrate concentration ... additional arguments deSolve::ode()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","text":"run Michaelis Menten ordinary differential equation forwards starting initial product concentration 0 specified kcat kM parameters specified time steps.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate Data from the Michaelis Menten Enzyme Kinetics — michaelis_menten","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","title":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","text":"set-Michaelis Menten enzyme kinetics model formula define ordinary differential equation model kcat, kM model parameters use michaelis_menten_model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","text":"","code":"michaelis_menten_formula(   series_index_variable = \"series_index\",   treatment_variable = \"time\",   treatment_units = \"seconds\",   ET_variable = \"ET\",   ET_units = \"mg/ml\",   ST_variable = \"ST\",   ST_units = \"mg/ml\",   response_variable = \"P\",   response_units = \"mg/ml\",   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","text":"series_index_variable character variable indexing measurements part common time series treatment_variable character variable representing time treatment treatment_units character units treatment variable ET_variable character variable representing total enzyme concentration ET_units character variable representing units enzyme concentration ST_variable character variable representing total substrate concentration ST_units character variable representing units substrate concentration response_variable character variable representing product response_units character units product predictors expression predictors kcat kM parameters ... additional arguments passed brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","text":"bpformula, subclass brms::brmsformula can passed michaelis_menten_model().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_formula.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Define a Formula for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_formula","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_genquant.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the Michaelis Menten Model Generated Quantities — michaelis_menten_genquant","title":"Stan Code for the Michaelis Menten Model Generated Quantities — michaelis_menten_genquant","text":"substrate concentration varied, generally possible fit kcat kM. However, possible fit ratio kcat/kM. Including rstan::stan code generate samples kcat/kM.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_genquant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the Michaelis Menten Model Generated Quantities — michaelis_menten_genquant","text":"","code":"michaelis_menten_genquant()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_genquant.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Stan Code for the Michaelis Menten Model Generated Quantities — michaelis_menten_genquant","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Parameter Values for the Michaelis Menten Enzyme Kinetic Model — michaelis_menten_init","title":"Initialize Parameter Values for the Michaelis Menten Enzyme Kinetic Model — michaelis_menten_init","text":"Initialize Parameter Values Michaelis Menten Enzyme Kinetic Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Parameter Values for the Michaelis Menten Enzyme Kinetic Model — michaelis_menten_init","text":"","code":"michaelis_menten_init(   kcat = function() runif(n = 1, min = 3, max = 5),   kM = function() runif(n = 1, max = 3, min = 5),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Parameter Values for the Michaelis Menten Enzyme Kinetic Model — michaelis_menten_init","text":"kcat numeric initial value kcat parameter Michaelis Menten model kM numeric initial value kM parameter Michaelis Menten model ... additional parameter initialization. named argument function returns numeric array depending dimension parameter, see rstan_default_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Parameter Values for the Michaelis Menten Enzyme Kinetic Model — michaelis_menten_init","text":"input [michaelis_menten_model](init = ...) parameter.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","title":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","text":"Model Michaelis Menten Enzyme Kinetics Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","text":"","code":"michaelis_menten_model(   data,   formula = michaelis_menten_formula(),   prior = michaelis_menten_prior(),   init = michaelis_menten_init(),   iter = 8000,   control = list(adapt_delta = 0.99),   stanvar_function = c(BayesPharma::michaelis_menten_stanvar(),     BayesPharma::michaelis_menten_genquant()),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","text":"data data.frame experimental data. must contain columns time P predictors specified formula. formula brms::brmsformula object. create dose-response brms::brmsformula, use michaelis_menten_formula function. prior brms::brmsprior kcat, kM. Use michaelis_menten_formula() create priors use . init list lists, numeric value, \"random\" initial values parameters modeled. iter numeric iterations model runs. Increasing iter can help model convergence. control named list parameters control sampler's behavior. Adding max_treedepth giving greater value 10 can improve model convergence. stanvar_function stan code model expose_functions logical. Expose BayesPharma functions model ... additional arguments passed brms::brm().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","text":"bpfit object, wrapper around brms::brmsfit object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_model.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Model for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_model","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_prior","title":"Create a Prior for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_prior","text":"kcat kM parameters, default priors gamma(4, 1). use gamma distribution naturally lower bounded 0. first parameter shape, alpha=4, second rate, beta=1. mean gamma distributions alpha/beta variance alpha/beta^2.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_prior","text":"","code":"michaelis_menten_prior(   kcat = brms::prior_string(prior = \"gamma(4, 1)\", lb = 0, nlpar = \"kcat\"),   kM = brms::prior_string(prior = \"gamma(4, 1)\", lb = 0, nlpar = \"kM\") )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior for the Michaelis Menten Enzyme Kinetics Model — michaelis_menten_prior","text":"kcat prior kcat parameter. Given numeric value, used constant estimated. kM prior kM parameter. Given numeric value, used constant estimated.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the Michaelis Menten Kinetics Model — michaelis_menten_stanvar","title":"Stan Code for the Michaelis Menten Kinetics Model — michaelis_menten_stanvar","text":"Michaelis Menten model ordinary differential equation model change product function total enzyme concentration (ET), total substrate concentration (ST), Michaelis constant (kM) catalytic constant (kcat). implement Michaelis Menten model rstan::stan, function michaelis_menten_ode defined passed michaelis_menten_single integrate using stiff backward differentiation formula (BDF) method. fit multiple time series one model, michaelis_menten_multiple can used. Note handle fitting time-series different numbers observations, additional series_index argument used. Note observations time-series sequential order supplied data.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the Michaelis Menten Kinetics Model — michaelis_menten_stanvar","text":"","code":"michaelis_menten_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_stanvar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Stan Code for the Michaelis Menten Kinetics Model — michaelis_menten_stanvar","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/michaelis_menten_stanvar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stan Code for the Michaelis Menten Kinetics Model — michaelis_menten_stanvar","text":"","code":"if (FALSE) { brms::brm(   data = ...,   formula = brms::brmsformula(     P ~ michaelis_menten_multiple(       series_index, time, kcat, kM, ET, ST),     kcat + kM ~ 1,     nl = TRUE,     loop = FALSE),   prior = ...,   init =  ...,   stanvars = BayesPharma::michaelis_menten_stanvar()) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_density_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Density Distribution of Model Parameters — plot_density_distribution","title":"Plot Density Distribution of Model Parameters — plot_density_distribution","text":"function useful observe distributions priors set brmsfit model. adding sample_prior = \"\" sigmoid_model brmsfit model, model samples prior distributions can observed using plot function verify values intended covered included.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_density_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Density Distribution of Model Parameters — plot_density_distribution","text":"","code":"plot_density_distribution(   model,   pars = NULL,   labeller = NULL,   title_label = \"Density Distributions\" )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_density_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Density Distribution of Model Parameters — plot_density_distribution","text":"model `brms::brmsfit model. pars parameters choose (Default b__Intercept') labeller strip 'b_' '_Intercept' parameter labels title_label character plot title.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_density_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Density Distribution of Model Parameters — plot_density_distribution","text":"ggplot2::ggplot() object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_density_distribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Density Distribution of Model Parameters — plot_density_distribution","text":"","code":"if (FALSE) {   plot_density_distribution(     model = my_sigmoid_model) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_drc.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Plot of a DRC Model — plot_drc","title":"Create Plot of a DRC Model — plot_drc","text":"Create Plot DRC Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_drc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Plot of a DRC Model — plot_drc","text":"","code":"plot_drc(   model,   newdata = NULL,   predict_args = list(interval = \"prediction\"),   aes_mapping = ggplot2::aes(x = .data[[\"log_dose\"]], y = .data[[\"response\"]]),   title = NULL )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_drc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Plot of a DRC Model — plot_drc","text":"model drc::drm model object generated drc::drm() newdata data.frame predictions made. Default: use range treatment values model object. predict_args list arguments passed predict(model, ...) including interval generate ribbon given type, see drc::predict.drc() details. aes_mapping [ggplot2::aes](...) mapping columns model data new data plot. (Default: ggplot2::aes](x = log_dose, y = response)) title character giving plot title","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","title":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","text":"plots bpfit() model density distribution parameter mean, lower confidence interval, upper confidence interval.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","text":"","code":"plot_posterior_density(   model,   predictors_col_name = \"_Intercept\",   half_max_label = \"ac50\",   l_ci = 0.025,   u_ci = 0.975,   title_label = \"Posterior Density Plots w/ Mean & 95% CI\" )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","text":"model bpfit model. predictors_col_name character predictors column input data.frame. Predictors perturbations tested experiment (.e. Drug, Temperature, etc.). half_max_label character label half maximal fits type experiment done (.e. ec50, ic50, ed50, id50, ld50, etc.). l_ci numeric unit lower confidence interval u_ci numeric unit upper confidence interval title_label string plot title.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","text":"ggplot2::ggplot() object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Posterior Density Distributions of modeled parameters — plot_posterior_density","text":"","code":"if (FALSE) {   plot_posterior_density(     model = my_sigmoid_model,     predictors_col_name = \"predictors\",     half_max_label = \"ic50\",     l_ci = 0.025,     u_ci = 0.975,     title_label = \"Posterior Density Plots with Mean and 95% CI\") }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_draws.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot of Posterior Model Fit Draws — plot_posterior_draws","title":"Plot of Posterior Model Fit Draws — plot_posterior_draws","text":"plot sample model fit draws posterior distribution expected mean median quantile intervals.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_draws.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot of Posterior Model Fit Draws — plot_posterior_draws","text":"","code":"plot_posterior_draws(   model,   newdata = NULL,   treatment_variable = NULL,   treatment_units = NULL,   treatment_from = NULL,   treatment_to = NULL,   response_variable = NULL,   response_units = NULL,   title = \"Dose-Response Posterior Draws\",   n = 50,   point_size = 0.75,   jitter_height = 0,   jitter_width = 0 )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_draws.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot of Posterior Model Fit Draws — plot_posterior_draws","text":"model bpfit object resulting fitting BayesPharma model newdata data.frame NULL new data use predictions. Default data.frame predictor treatment variable. treatment_variable character NULL. NULL treatment variable name looked model. treatment variable model$data newdata supplied must column corresponding treatment variable. treatment_units character NULL. NULL treatment units looked model. treatment units used label X-axis plot. treatment_from numeric NULL, lower bound treatment range. NULL, use (finite) lower bound treatment variable model data. treatment_to numeric NULL, upper bound treatment range. NULL, use (finite) upper bound treatment variable model data. response_variable string NULL. NULL response variable name looked model. response variable model$data newdata supplied must column corresponding response variable. response_units character NULL. NULL response units looked model. response units used label Y-axis plot. title character name plot n numeric value number draws show. point_size numeric. ggplot2::geom_jitter() point size. jitter_height numeric. height distance overlapping points. jitter_width numeric. width distance overlapping points.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_draws.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot of Posterior Model Fit Draws — plot_posterior_draws","text":"ggplot2::ggplot object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_posterior_draws.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot of Posterior Model Fit Draws — plot_posterior_draws","text":"","code":"if (FALSE) {   # Consider a model named my_model and data named my_data with a column   # named predictors containing multiple different perturbations.   plot_posterior_draws(     model = my_model,     newdata = my_data,     predictors_col_name = \"predictors\",     lower = -12,     upper = -3,     n = 50,     facet_var = predictors,     jitter_width = 0.10,     title = \"Dose-Response Posterior Draws\",     xlab = \"Log[Molar]\",     ylab = \"Response\") }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_pp_check.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Posterior Predictive Check — plot_pp_check","title":"Perform Posterior Predictive Check — plot_pp_check","text":"Given brms model, perform graphical posterior predictive check. pp_check brms package different plot types analyze model fit comparing observed data generated data model. documentation pp_check: http://paul-buerkner.github.io/brms/reference/pp_check.brmsfit.html documentation pp_check plot types PPC plotting functions: https://mc-stan.org/bayesplot/reference/PPC-overview.html","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_pp_check.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Posterior Predictive Check — plot_pp_check","text":"","code":"plot_pp_check(model, plot_type = \"dens_overlay\", n = 50, ...)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_pp_check.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Posterior Predictive Check — plot_pp_check","text":"model brmsfit model. plot_type character plot type. n numeric number posterior draws used. ... additional arguments brms::pp_check().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_pp_check.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform Posterior Predictive Check — plot_pp_check","text":"ggplot2::ggplot() object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_pp_check.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform Posterior Predictive Check — plot_pp_check","text":"","code":"if (FALSE) { # Consider a dose response model with the plot type being 10 box plots BayesPharma::plot_pp_check(   model = my_dose_response_model,   plot_type = \"box_plot\",   n = 10) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_prior_posterior_densities.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","title":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","text":"Generate plot shows model variable distribution marginal posterior uncertainty overlaid distribution marginal prior uncertainty.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_prior_posterior_densities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","text":"","code":"plot_prior_posterior_densities(   model,   predictors_col_name = \"_Intercept\",   half_max_label = \"ec50\",   title_label = \"Prior Posterior Density\",   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_prior_posterior_densities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","text":"model bpfit object resulting fitting BayesPharma model predictors_col_name string expression predictors column input data.frame (default = \"_Intercept\"). Predictors perturbations tested experiment (.e. Drug, Temperature, etc.). half_max_label string label half maximal fits type experiment done (.e. ec50, ic50, ed50, id50, ld50, etc.). title_label string plot title. ... arguments passed stats::update() sample prior","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_prior_posterior_densities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","text":"ggplot2::ggplot() object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_prior_posterior_densities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Prior and Posterior Marginal Distributions — plot_prior_posterior_densities","text":"","code":"if (FALSE) {   plot_prior_posterior_densities(     model = my_sigmoid_model,     predictors_col_name = \"predictors\",     half_max_response = \"ic50\",     title_label = \"Prior Posterior Density Plots\") }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_sigmoid_functional_form.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","title":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","text":"Generates plot sigmoid() functional form values parameters ac50, hill, top, bottom labeled.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_sigmoid_functional_form.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","text":"","code":"plot_sigmoid_functional_form(   ac50,   hill,   top,   bottom,   log_dose,   treatment_units,   response_units )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_sigmoid_functional_form.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","text":"ac50 numeric value ac50 parameter, either ec50 sigmoid_agonist_formula() ic50 sigmoid_antagonist_formula() hill numeric value hill parameter top numeric value top parameter bottom numeric value bottom parameter log_dose numeric vector treatment values treatment_units character units log dose response_units character units response","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_sigmoid_functional_form.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","text":"ggplot2::ggplot() object","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_sigmoid_functional_form.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the Sigmoid Functional Form with Labeled Parameters — plot_sigmoid_functional_form","text":"","code":"if (FALSE) {   plot_sigmoid_functional_form(     ac50 = -6,     hill = -1,     top = 100,     bottom = 0,     treatment_label = \"Log[Molar]\",     response_label = \"% Baseline\")}"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_synergy_checkerboard.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Synergy Checkerboard — plot_synergy_checkerboard","title":"Plot Synergy Checkerboard — plot_synergy_checkerboard","text":"Plot Synergy Checkerboard","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_synergy_checkerboard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Synergy Checkerboard — plot_synergy_checkerboard","text":"","code":"plot_synergy_checkerboard(   data,   treatment_1_variable = \"dose1\",   treatment_2_variable = \"dose2\",   response_variable = \"response\",   treatment_1_label = \"Treatment 1\",   treatment_2_label = \"Treatment 2\",   treatment_1_units = NULL,   treatment_2_units = NULL,   plot_zero_dose = TRUE,   contour_color = \"gold\" )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_synergy_checkerboard.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Synergy Checkerboard — plot_synergy_checkerboard","text":"data data.frame columns provided treatment_1_variable, treatment_2_variable, response_variable treatment_1_variable character column name treatment 1 treatment_2_variable character column name treatment 2 response_variable character column name response treatment_1_label character used make default title axis labels treatment_2_label character used make default title axis labels treatment_1_units character used make default axis labels treatment_2_units character used make default axis labels plot_zero_dose logical plotted log scale, zero doses -Inf, show plot, add slight separation axis. contour_color character color contour lines","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/plot_synergy_checkerboard.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Synergy Checkerboard — plot_synergy_checkerboard","text":"ggplot2::ggplot plot light-blue dark-blue tiles dose response. Individual plot elements can -written plot can saved ggplot2::ggsave()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper Function to Prepare an Init for a brms Model — prepare_init","title":"Helper Function to Prepare an Init for a brms Model — prepare_init","text":"Helper Function Prepare Init brms Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper Function to Prepare an Init for a brms Model — prepare_init","text":"","code":"prepare_init(init)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper Function to Prepare an Init for a brms Model — prepare_init","text":"init function returning numeric array length 1 numeric value.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper Function to Prepare an Init for a brms Model — prepare_init","text":"function returning numeric  array length 1.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","title":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","text":"extends brms::prior() allowing just taking numeric value rather constant(<value>) specify constant prior brms::brmsprior given, checks specified arguments used building BayesPharma models allow user specified priors make sure right parameters make sure model well specified.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","text":"","code":"prepare_prior(prior, ...)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","text":"prior brms::brmsprior() numeric. ... additional arguments brms::prior_string(). prior brms::brmsprior() check slots given values. prior numeric, arguments passed brms::prior_string()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","text":"brms::brmsprior()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/prepare_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper Function to Prepare a Prior for a brms Model — prepare_prior","text":"","code":"if (FALSE) {   # user should specify a prior for hill, but they misspell it:   user_hill_prior <- brms::prior(     prior = normal(1, 1),     nlpar = \"hilll\",     ub = 0)    # in a script where we want to validate the user_hill_prior   hill_prior <- BayesPharma:::prepare_prior(     prior = user_hill_prior,     nlpar = \"hill\")    # gives an assert error that nlpar is not set correctly }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/rstan_default_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper Function to Create the Default rstan scalar init — rstan_default_init","title":"Helper Function to Create the Default rstan scalar init — rstan_default_init","text":"default, rstan initialize parameters uniformly random range (-2, 2), unconstrained scale. Description stan transforms parameters satisfy constraints described stan documentation https://mc-stan.org/docs/reference-manual/variable-transforms.html helper especially useful running models using cmdstanr backend, requires parameters (including distributional) parameters initialized.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/rstan_default_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper Function to Create the Default rstan scalar init — rstan_default_init","text":"","code":"rstan_default_init(lb = NULL, ub = NULL, dim = 0)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/rstan_default_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper Function to Create the Default rstan scalar init — rstan_default_init","text":"lb numeric lower bound parameter ub numeric upper bound parameter dim numeric dimension parameter.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/rstan_default_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper Function to Create the Default rstan scalar init — rstan_default_init","text":"function return default brms initial value parameter. dim=0, numeric scalar, dim=1 greater, return array given dimension.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/rstan_default_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper Function to Create the Default rstan scalar init — rstan_default_init","text":"","code":"if (FALSE) {  # Explicitly set the default initialization for the distributional parameter # 'sigma' when family=gaussian(). init <- BayesPharma::sigmoid_antagonist_init(   sigma = BayesPharma::rstan_default_scalar_init(lb = 0))  }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Sigmoid Function — sigmoid","title":"Sigmoid Function — sigmoid","text":"Functional form sigmoid model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sigmoid Function — sigmoid","text":"","code":"sigmoid(ac50, hill, top, bottom, log_dose)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sigmoid Function — sigmoid","text":"ac50 numeric, log_dose half maximal activity hill numeric, slope curve ac50 units response/log_dose top numeric, value maximal response positive slope, occurs log_dose = Inf, negative slope log_dose = -Inf bottom numeric, value minimal response positive slope, occurs log_dose = -Inf, negative slope log_dose = Inf log_dose numeric, evaluate response log base 10.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sigmoid Function — sigmoid","text":"numeric, response given log_dose parameters","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sigmoid Function — sigmoid","text":"","code":"if (FALSE) {  # Generate an agonist curve with an ec50 of 1 μM with the response  # normalized to [0, 1] over the range 100 nM to 10 μM with half-log steps  data <- data.frame(    log_dose = seq(-7, -5, length.out = 5)) |>      dplyr::mutate(        response = stats::rnorm(          n = length(log_dose),          mean = BayesPharma::sigmoid(            ac50 = -6,            hill = 1,            top = 1,            bottom = 0,            log_dose = log_dose),        sd = .2)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","title":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","text":"set-sigmoid dose response model formula define non-linear model multilevel non-linear model ec50, hill, top, , bottom use sigmoid_model .","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","text":"","code":"sigmoid_agonist_formula(   treatment_variable = \"log_dose\",   treatment_units = \"Log[Molar]\",   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","text":"treatment_variable character variable representing treatment. treatment_units character units treatment. default log base 10 molar concentration. response_variable character variable representing response treatment. response_units character units response. predictors character expression predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? ... additional arguments brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","text":"bpformula, subclass brms::brmsformula can passed sigmoid_model().","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an Agonist Sigmoid Formula for the Sigmoid Model — sigmoid_agonist_formula","text":"","code":"if (FALSE) {   # Data has a string column drug_id with drug identifiers   # Fit a separate model for each drug   BayesPharma::sigmoid_agonist_formula(predictors = 0 + drug_id)    # Data has a string column plate_id with plate identifiers   # Estimate the change in response for each plate relative to a global   # baseline.   BayesPharma::sigmoid_agonist_formula(predictors = plate_id)    # data has columns drug_id and plate_id   # fit a multilevel model where the drug effect depends on the plate   BayesPharma::sigmoid_agonist_formula(predictors = 0 + (drug_id|plate_id)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","title":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","text":"Creating initial values agonist sigmoid model parameters can passed sigmoid_model() along sigmoid_agonist_formula() sigmoid_agonist_prior().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","text":"","code":"sigmoid_agonist_init(   ec50 = function() runif(n = 1, min = -7, max = -5),   hill = function() runif(n = 1, min = 0.8, max = 1.2),   top = function() runif(n = 1, min = 0.8, max = 1.2),   bottom = function() runif(n = 1, min = -0.2, max = 0.2),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","text":"ec50 numeric numeric returning function units treatment. treatment log_dose, default value -6 corresponds 1e-6 molar = 1 μM hill numeric numeric returning function units response/log_dose top numeric numeric returning function units response bottom numeric numeric returning function units response ... additional parameter initialization. named argument function returns numeric array depending dimension parameter, see rstan_default_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","text":"input [brms::brm](init = ...)","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize Parameter Values for an Agonist Sigmoid Model — sigmoid_agonist_init","text":"","code":"if (FALSE) { #Consider an activator that has a max response around 50%, EC50 is estimated #to be around 1 nM, minimum response is known to be 0. init <- BayesPharma::sigmoid_agonist_init(   ec50 = -9,   top = 0.5) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","title":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","text":"Creates data.frame priors sigmoid agonist model function arguments ec50, hill, top, bottom NULL, default normal distribution priors set. like set parameter constant, enter numeric value function argument. distribution options, reference brms::prior Prior Choice Recommendations","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","text":"","code":"sigmoid_agonist_prior(   ec50 = brms::prior(prior = normal(-6, 2.5), nlpar = \"ec50\"),   hill = brms::prior(prior = normal(1, 1), nlpar = \"hill\", lb = -0.01),   top = brms::prior(prior = normal(1, 0.5), nlpar = \"top\"),   bottom = brms::prior(prior = normal(0, 0.5), nlpar = \"bottom\"),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","text":"ec50 brms::brmsprior numeric. Prior ec50 parameter.  Setting ec50 numeric value constrains constant value. Default: normal(-6, 2.5) mean -6 corresponds concentration 1e-6 1 μM. hill brms::brmsprior numeric. Prior hill parameter. Default: normal(1, 1) lower bound -0.1. top brms::brmsprior numeric giving prior top parameter. Setting top numeric constrains constant value. bottom brms::brmsprior numeric giving prior bottom parameter. Setting bottom numeric constrains constant value. ... additional brms::brmsprior objects.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","text":"brms::brmsprior","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_agonist_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Prior an Agonist Sigmoid Model — sigmoid_agonist_prior","text":"","code":"if (FALSE) { # Consider an activator that has a max response around 50%, EC50 is estimated # to be around 1 nM, and minimum response is known to be 0. priors <- sigmoid_agonist_prior(   ec50 = brms::prior(prior = normal(-9, 0.5), nlpar = \"ec50\"),   top = brms::prior(prior = normal(0.5, 0.2), nlpar = \"top\"),   bottom = 0) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","title":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","text":"Set-antagonist sigmoid dose response model formula define non-linear model multilevel non-linear model ic50, hill, top, , bottom use sigmoid_model().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","text":"","code":"sigmoid_antagonist_formula(   treatment_variable = \"log_dose\",   treatment_units = \"Log[Molar]\",   response_variable = \"response\",   response_units = NULL,   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","text":"treatment_variable character variable representing treatment. treatment_units character units treatment. default log base 10 molar concentration. response_variable character variable representing response treatment. response_units character units response. predictors character expression predictors non-linear parameters. .e. perturbations/experimental differences modeled separately? ... additional arguments brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","text":"bpformula, subclass brms::brmsformula can passed sigmoid_model().","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Formula for the Sigmoid Antagonist Model — sigmoid_antagonist_formula","text":"","code":"if (FALSE) {   # Data has a string column drug_id with drug identifiers   # Fit a separate model for each drug   BayesPharma::sigmoid_antagonist_formula(predictors = 0 + drug_id)    # Data has a string column plate_id with plate identifiers   # Estimate the change in response for each plate relative to a global   # baseline.   BayesPharma::sigmoid_antagonist_formula(predictors = plate_id)    # data has columns drug_id and plate_id   # fit a multilevel model where the drug effect depends on the plate   BayesPharma::sigmoid_antagonist_formula(     predictors = 0 + (drug_id|plate_id)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","title":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","text":"Creating initial values agonist sigmoid model parameters can passed sigmoid_model() along sigmoid_antagonist_formula() sigmoid_antagonist_prior().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","text":"","code":"sigmoid_antagonist_init(   ic50 = function() runif(n = 1, min = -7, max = -5),   hill = function() runif(n = 1, min = -1.2, max = -0.8),   top = function() runif(n = 1, min = 0.8, max = 1.2),   bottom = function() runif(n = 1, min = -0.2, max = 0.2),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","text":"ic50 numeric numeric returning function units treatment. treatment log_dose, default value -6 corresponds 1e-6 molar = 1 μM hill numeric numeric returning function units response/log_dose top numeric numeric returning function units response bottom numeric numeric returning function units response ... additional parameter initialization. named argument function returns numeric array length 1, see rstan_default_scalar_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","text":"input [brm][brms::brm](init = ...)","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize Parameter Values for an Antagonist Sigmoid Model — sigmoid_antagonist_init","text":"","code":"if (FALSE) { # Consider an inhibitor that has a min response around 50%, IC50 is estimated # to be around 1 nM, maximum response is known to be around 1, init <- BayesPharma::sigmoid_antagonist_init(   ec50 = -9,   bottom = 0.5)  # By default rstan initializes unspecified initial values to be uniformly at # random in the range (-2, 2) on the unconstrained scale. For the default # distributional response, family=gaussian(), the shape parameter sigma' is # bounded below by zero through this transformation Y = log(X - 0). So, to # explicitly give the default initialization for 'sigma', we can use init <- BayesPharma::sigmoid_antagonist_init(   sigma = BayesPharma::rstan_default_init(lb = 0)) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","title":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","text":"Creates data.frame priors sigmoid antagonist model function arguments ic50, hill, top, bottom = NULL, default normal distribution priors set. like set parameter constant, enter numeric value function argument. distribution options, reference brms::prior Prior Choice Recommendations","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","text":"","code":"sigmoid_antagonist_prior(   ic50 = brms::prior(prior = normal(-6, 2.5), nlpar = \"ic50\"),   hill = brms::prior(prior = normal(-1, 1), nlpar = \"hill\", ub = 0.01),   top = brms::prior(prior = normal(1, 0.5), nlpar = \"top\"),   bottom = brms::prior(prior = normal(0, 0.5), nlpar = \"bottom\"),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","text":"ic50 brms::brmsprior() numeric. Prior ic50 parameter. (Default: normal(-6, 2.5) mean -6 corresponds concentration 1e-6 1 μM. Setting ic50 numeric value constrains constant value. hill brms::brmsprior() numeric. Prior hill parameter. (Default: normal(-1, 1) upper bounded 0.1). top brmsprior numeric giving prior top parameter. Setting top numeric constrains constant value. bottom brmsprior numeric giving prior bottom parameter. Setting bottom numeric constrains constant value. ... additional brms::brmsprior objects.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","text":"brms::brmsprior","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_antagonist_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Prior an Antagonist Sigmoid Model — sigmoid_antagonist_prior","text":"","code":"if (FALSE) { # Consider an activator that has a max response around 50%, EC50 is estimated # to be around 1 μM, and minimum response is known to be 0. priors <- sigmoid_antagonist_prior(   ic50 = brms::prior(prior = normal(-6, 0.5), nlpar = \"ic50\"),   top = brms::prior(prior = normal(0.5, 0.5), nlpar = \"top\"),   bottom = 0) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_hill_to_slope.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Hill to Slope Parameters a the Sigmoid Functional Form — sigmoid_hill_to_slope","title":"Convert Hill to Slope Parameters a the Sigmoid Functional Form — sigmoid_hill_to_slope","text":"hill parameter controls slope ac50 (slope) slope also depends top bottom parameters. helper function facilitates computing slope parameters. prove function correct, consider derivative response sigmoid() function respect log_dose: Evaluating derivative log_dose == ac50 simplifies exponents:","code":"d(response)/d(log_dose) =     hill * log(10) * (top - bottom) * 10 ^ ((ac50 - log_dose) * hill) /     ((10 ^ ((ac50 - log_dose) * hill) + 1) ^ 2) slope = hill * log(10) * (top - bottom) / (1 + 1) ^ 2)         = hill * log(10) * (top - bottom) / 4"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_hill_to_slope.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Hill to Slope Parameters a the Sigmoid Functional Form — sigmoid_hill_to_slope","text":"","code":"sigmoid_hill_to_slope(hill, top, bottom)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_hill_to_slope.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Hill to Slope Parameters a the Sigmoid Functional Form — sigmoid_hill_to_slope","text":"hill numeric hill coefficient sigmoid() function. top numeric top parameter sigmoid() function. bottom numeric bottom parameter sigmoid() function.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_hill_to_slope.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Hill to Slope Parameters a the Sigmoid Functional Form — sigmoid_hill_to_slope","text":"numeric slope sigmoid() function ac50.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Bayesian Sigmoid Model — sigmoid_model","title":"Fit a Bayesian Sigmoid Model — sigmoid_model","text":"Fits sigmoid model. functional form default observed data (therefore columns input data data.frame) treatment: log_dose, log10 dose molar concentration response: response, unspecified units modeled parameters ac50: dose response reaches half maximal activity hill: hill coefficient controlling slope ac50, convention slope agonist positive top: response  => Inf bottom: response  => -Inf configure model can use following helper functions agonist models sigmoid_agonist_formula(): define response relates treatment parameters ac50->ec50, covariates predict parameters sigmoid_agonist_prior(): define prior model parameters, slope constrained positive sigmoid_agonist_init(): define initial values model parameters match default sigmoid_agonist_prior() following helper functions antagonist model sigmoid_antagonist_formula(): define response relates treatment parameters ac50->ic50, covariates predict parameters sigmoid_antagonist_prior(): define prior model parameters, slope constrained negative sigmoid_antagonist_init(): define initial values model parameters match default sigmoid_antagonist_prior()","code":"<response> ~ sigmoid(ac50, hill, top, bottom, <treatment>) sigmoid = bottom + (top - bottom)/(1 + 10^((ac50 - <treatment>) * hill))"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Bayesian Sigmoid Model — sigmoid_model","text":"","code":"sigmoid_model(   data,   formula = sigmoid_agonist_formula(),   prior = sigmoid_agonist_prior(),   init = sigmoid_agonist_init(),   iter = 8000,   control = list(adapt_delta = 0.99),   stanvar_function = sigmoid_stanvar(),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Bayesian Sigmoid Model — sigmoid_model","text":"data data.frame observed data. must contain columns treatment, response additional predictors specified formula. See sigmoid_agonist_formula() details. formula bpformula formula sigmoid model (see ). prior brmsprior defining distribution model parameters defined formula. (see ). init function initialize brms::brm model parameters (see ) iter numeric iterations model runs. Increasing iter can help model convergence (see brms::brm) control named list arguments control sampler's behavior.  Adding max_treedepth giving greater value 10 can improve model convergence (see brms::brm) stanvar_function stan code model. expose_functions logical. Expose sigmoid function used model. needed e.g. brms::loo_compare() ... additional arguments passed brms::brm","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Bayesian Sigmoid Model — sigmoid_model","text":"bpfit object, wrapper around brms::brmsfit object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a Bayesian Sigmoid Model — sigmoid_model","text":"","code":"if (FALSE) {   BayesPharma::sigmoid_model(     data = data,     formula = BayesPharma::sigmoid_antagonist_formula(predictors = 0 + drug),     prior = BayesPharma::sigmoid_antagonist_prior(),     init = BayesPharma::sigmoid_antagonist_init()) }"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_slope_to_hill.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Slope to Hill Parameters a the Sigmoid Functional Form — sigmoid_slope_to_hill","title":"Convert Slope to Hill Parameters a the Sigmoid Functional Form — sigmoid_slope_to_hill","text":"hill parameter controls slope ac50 (slope) slope also depends top bottom parameters. helper function facilitates computing hill parameters. prove function correct, re-arrange equation relating slope hill parameters","code":"hill * log(10) * (top - bottom) / 4 = slope   hill = slope * 4 / (log10 * (top - bottom))"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_slope_to_hill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Slope to Hill Parameters a the Sigmoid Functional Form — sigmoid_slope_to_hill","text":"","code":"sigmoid_slope_to_hill(slope, top, bottom)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_slope_to_hill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Slope to Hill Parameters a the Sigmoid Functional Form — sigmoid_slope_to_hill","text":"slope numeric slope sigmoid() ac50 top numeric top parameter sigmoid() function. bottom numeric bottom parameter sigmoid() function.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_slope_to_hill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Slope to Hill Parameters a the Sigmoid Functional Form — sigmoid_slope_to_hill","text":"numeric hill coefficient sigmoid() function .","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the Sigmoid Model. — sigmoid_stanvar","title":"Stan Code for the Sigmoid Model. — sigmoid_stanvar","text":"Stan Code Sigmoid Model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the Sigmoid Model. — sigmoid_stanvar","text":"","code":"sigmoid_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/sigmoid_stanvar.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Stan Code for the Sigmoid Model. — sigmoid_stanvar","text":"stanvar script sigmoid dose response equation.  log dose greater negative infinity (dose greater 0), sigmoid dose response equation used. ac50 half maximal response, hill slope, top maximum response, bottom minimum response. log dose equal negative infinity (dose equal 0), hill positive, bottom value returned. hill negative, top value returned.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","title":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","text":"set-tQ enzyme kinetics model formula define ordinary differential equation model kcat, kM model parameters use tQ_model.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","text":"","code":"tQ_formula(   series_index_variable = \"series_index\",   treatment_variable = \"time\",   treatment_units = \"seconds\",   ET_variable = \"ET\",   ET_units = \"mg/ml\",   ST_variable = \"ST\",   ST_units = \"mg/ml\",   response_variable = \"P\",   response_units = \"mg/ml\",   predictors = 1,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","text":"series_index_variable character variable indexing measurements part common time series treatment_variable character variable representing time treatment treatment_units character units treatment variable ET_variable character variable representing total enzyme concentration ET_units character variable representing units enzyme concentration ST_variable character variable representing total substrate concentration ST_units character variable representing units substrate concentration response_variable character variable representing product response_units character units product predictors expression predictors kcat kM parameters ... additional arguments passed brms::brmsformula()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","text":"bpformula, subclass brms::brmsformula can passed tQ_model().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_formula.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Define a Formula for the Total QSSA (tQ) Enzyme Kinetics Model — tQ_formula","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_genquant.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the tQ Model Generated Quantities — tQ_genquant","title":"Stan Code for the tQ Model Generated Quantities — tQ_genquant","text":"substrate concentration varied, generally possible fit kcat kM. However, possible fit ratio kcat/kM. Including rstan::stan code generate samples kcat/kM.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_genquant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the tQ Model Generated Quantities — tQ_genquant","text":"","code":"tQ_genquant()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_genquant.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Stan Code for the tQ Model Generated Quantities — tQ_genquant","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Parameter Values for the tQ Enzyme Kinetic Model — tQ_init","title":"Initialize Parameter Values for the tQ Enzyme Kinetic Model — tQ_init","text":"Initialize Parameter Values tQ Enzyme Kinetic Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Parameter Values for the tQ Enzyme Kinetic Model — tQ_init","text":"","code":"tQ_init(   kcat = function() runif(n = 1, min = 3, max = 5),   kM = function() runif(n = 1, min = 3, max = 5),   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Parameter Values for the tQ Enzyme Kinetic Model — tQ_init","text":"kcat numeric initial value kcat parameter tQ model kM numeric initial value kM parameter tQ model ... additional parameter initialization. named argument function returns numeric array depending dimension parameter, see rstan_default_init() use rstan default init.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Parameter Values for the tQ Enzyme Kinetic Model — tQ_init","text":"input [tQ_model](init = ...) parameter.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Model for the tQ Enzyme Kinetics Model — tQ_model","title":"Model for the tQ Enzyme Kinetics Model — tQ_model","text":"Model tQ Enzyme Kinetics Model","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model for the tQ Enzyme Kinetics Model — tQ_model","text":"","code":"tQ_model(   data,   formula = tQ_formula(),   prior = tQ_prior(),   init = tQ_init(),   iter = 8000,   control = list(adapt_delta = 0.99),   stanvar_function = c(BayesPharma::tQ_stanvar(), BayesPharma::tQ_genquant()),   expose_functions = TRUE,   ... )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model for the tQ Enzyme Kinetics Model — tQ_model","text":"data data.frame experimental data. must contain columns time P predictors specified formula. formula brms::brmsformula object. create dose-response brms::brmsformula, use tQ_formula function. prior brms::brmsprior kcat, kM. Use tQ_formula() create priors use . init list lists, numeric value, \"random\" initial values parameters modeled. iter numeric iterations model runs. Increasing iter can help model convergence. control named list parameters control sampler's behavior. Adding max_treedepth giving greater value 10 can improve model convergence. stanvar_function stan code model expose_functions logical. Expose BayesPharma functions model ... additional arguments passed brms::brm().","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model for the tQ Enzyme Kinetics Model — tQ_model","text":"bpfit object, wrapper around brms::brmsfit object.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Model for the tQ Enzyme Kinetics Model — tQ_model","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"Simulate data total QSSA (tQ) model refinement classical Michaelis-Menten enzyme kinetics ordinary differential equation described (Choi, et al., 2017, DOI: 10.1038/s41598-017-17072-z). Consider kinetic rate equation","code":"kf                  --->    kcat           E + S  <---  C --->  E + P                   kb"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"","code":"tQ_model_generate(time, kcat, kM, ET, ST, ...)"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"time numeric vector. Increasing time points kcat numeric value catalytic rate constant kM numeric value Michaelis rate constant ET numeric value total enzyme concentration ST numeric value total substrate concentration ... additional arguments deSolve::ode()","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"run tQ ordinary differential equation forwards starting initial product concentration 0 specified kcat kM parameters specified time steps.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"free enzyme (E) reversibly binds substrate (S) form complex (C) forward backward rate constants kf kb, irreversibly catalyzed product (P), rate constant kcat, releasing enzyme catalyze additional substrate. total enzyme concentration defined ET := E + C. total substrate product concentration defined ST := S + C + P. Michaelis constant defined kM := (kb + kcat) / kf. kcat rate constant determines maximum turn saturating substrate concentrations, Vmax := kcat * ET. rate constants kcat kM can estimated monitoring product accumulation time (enzyme progress curves), varying enzyme substrate concentrations. (Choi, et al, 2017, equation 2, total quasi-steady-state approximation (tQ) differential equation defined (Choi, et al. 2017) prove, tQ model valid K = kb/kf dissociation constant.","code":"Observed data:      M     = number of measurements        # number of measurements      t[M]  = time                          # measured in seconds      Pt[M] = product                       # product produced at time t      ST    = substrate total concentration # specified for each experiment      ET    = enzyme total concentration    # specified for each experiment    Model parameters:     kcat    # catalytic constant (min^-1)     kM      # Michaelis constant ()    ODE formulation:     dPdt = kcat * (              ET + kM + ST - Pt +              -sqrt((ET + kM + ST - Pt)^2 - 2 * ET * (ST - Pt))) / 2    initial condition:      P := 0 K/(2*ST) * (ET+kM+ST) / sqrt((ET+kM+ST+P)^2 - 4*ET(ST-P)) << 1,"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_model_generate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate Data from the Total QSSA (tQ) Model for Enzyme Kinetics — tQ_model_generate","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Prior for the tQ Enzyme Kinetics Model — tQ_prior","title":"Create a Prior for the tQ Enzyme Kinetics Model — tQ_prior","text":"kcat kM parameters, default priors gamma(4, 1). use gamma distribution naturally lower bounded 0. first parameter shape, alpha=4, second rate, beta=1. mean gamma distributions alpha/beta variance alpha/beta^2.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Prior for the tQ Enzyme Kinetics Model — tQ_prior","text":"","code":"tQ_prior(   kcat = brms::prior_string(prior = \"gamma(4, 1)\", lb = 0, nlpar = \"kcat\"),   kM = brms::prior_string(prior = \"gamma(4, 1)\", lb = 0, nlpar = \"kM\") )"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Prior for the tQ Enzyme Kinetics Model — tQ_prior","text":"kcat prior kcat parameter. Given numeric value, used constant estimated. kM prior kM parameter. Given numeric value, used constant estimated.","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_stanvar.html","id":null,"dir":"Reference","previous_headings":"","what":"Stan Code for the tQ Enzyme Kinetics Model — tQ_stanvar","title":"Stan Code for the tQ Enzyme Kinetics Model — tQ_stanvar","text":"tQ ordinary differential equation model total quasi-steady-state assumption kinetics defined (Choi et al., 2017), related Michaelis-Menten kinetics model, assume enzyme concentration negligibly small. implement tQ model Stan, function tQ_ode defined passed tQ_single integrate using stiff backward differentiation formula (BDF) method. fit multiple time series one model, tQ_multiple can used. Note handle fitting time-series different numbers observations, additional series_index argument used. Note observations time-series sequential order supplied data.","code":""},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_stanvar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stan Code for the tQ Enzyme Kinetics Model — tQ_stanvar","text":"","code":"tQ_stanvar()"},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_stanvar.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Stan Code for the tQ Enzyme Kinetics Model — tQ_stanvar","text":"Choi, B., Rempala, G.. & Kim, J.K. Beyond Michaelis-Menten equation: Accurate efficient estimation enzyme kinetic parameters. Sci Rep 7, 17018 (2017). https://doi.org/10.1038/s41598-017-17072-z","code":""},{"path":[]},{"path":"https://api.github.com/repos/maomlab/BayesPharma/pages/reference/tQ_stanvar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stan Code for the tQ Enzyme Kinetics Model — tQ_stanvar","text":"","code":"if (FALSE) { brms::brm(   data = ...,   formula = brms::brmsformula(     P ~ tQ_multiple(series_index, time, kcat, kM, ET, ST),     kcat + kM ~ 1,     nl = TRUE,     loop = FALSE),   prior = ...,   init =  ...,   stanvars = BayesPharma::tQ_stanvar()) }"}]
