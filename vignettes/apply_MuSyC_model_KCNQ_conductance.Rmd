---
title: "Apply: MuSyC Model -- KCNQ Conductance"
description: Demonstrate the MuSyC_model to analyze the interaction between
  voltage and small molecules interact modulate conductance through the KCNQ2
  voltage gated potassium channel.
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{Apply: MuSyC Model -- KCNQ Conductance}
  %\VignetteEncoding{UTF-8}
---


```
model_meanfield <- BayesPharma::MuSyC_model(
  data = model_data,
  algorithm = "meanfield")

model <- BayesPharma::MuSyC_model(
  data = model_data)

```


```{r plot-checkerboard}

plot_data <- data |>
  dplyr::filter(
    treatment == "ztz240",
    is_control == FALSE) |>
  dplyr::transmute(
    response = conductance,
    dose1 = dose_uM,
    dose2 = 10^(voltage),

BayesPharma::plot_synergy_checkerboard(
  data = plot_data,
  treatment_1_label = "ztz240",
  treatment_1_units = "Î¼M",
  treatment_2_label = "Voltage",
  treatment_2_units = "mV") +
  ggplot2::coord_cartesian(default = TRUE) +
  ggplot2::scale_y_continuous(
    "Voltage (mV)",
    breaks = data$voltage |> unique() |> sort(),
    labels = signif(d2_label, 3),
      expand = c(0, 0))
```


```
## Error in predict(model, newdata = tidyr::expand_grid(logd1 = seq(-1, 1, : object 'model' not found
```
